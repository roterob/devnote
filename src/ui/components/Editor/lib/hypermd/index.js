/*!
 * HyperMD, copyright (c) by laobubu
 * Distributed under an MIT license: http://laobubu.net/HyperMD/LICENSE
 *
 * Break the Wall between writing and preview, in a Markdown Editor.
 *
 * HyperMD makes Markdown editor on web WYSIWYG, based on CodeMirror
 *
 * Homepage: http://laobubu.net/HyperMD/
 * Issues: https://github.com/laobubu/HyperMD/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("codemirror"),require("codemirror/addon/fold/foldcode"),require("codemirror/addon/fold/foldgutter"),require("codemirror/addon/fold/markdown-fold"),require("codemirror/addon/edit/closebrackets"),require("codemirror/lib/codemirror.css"),require("codemirror/addon/fold/foldgutter.css"),require("codemirror/mode/meta")):"function"==typeof define&&define.amd?define(["exports","codemirror","codemirror/addon/fold/foldcode","codemirror/addon/fold/foldgutter","codemirror/addon/fold/markdown-fold","codemirror/addon/edit/closebrackets","codemirror/lib/codemirror.css","codemirror/addon/fold/foldgutter.css","codemirror/mode/meta"],t):t(e.HyperMD={},e.CodeMirror)}(this,function(e,R){"use strict";"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){var n=arguments;if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),i=1;i<arguments.length;i++){var o=n[i];if(null!=o)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])}return r},writable:!0,configurable:!0});function a(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r="enabled"),this.on_cb=e,this.off_cb=t,this.state=n,this.subkey=r}function d(t,n,r){n=~~n||5;var i=250;setTimeout(function e(){if(n--){try{if(t())return}catch(e){}setTimeout(e,i),i*=2}else r&&r()},0)}function u(e,t){function n(){e(),i=0}function r(){var e=+new Date;if(i){if(e<o)return;clearTimeout(i)}i=setTimeout(n,t),o=100+e}var i=null,o=0;return r.stop=function(){i&&(clearTimeout(i),i=0)},r}a.prototype.ON=function(e){return this.on_cb=e,this},a.prototype.OFF=function(e){return this.off_cb=e,this},a.prototype.set=function(e,t){e="object"==typeof e&&e?e[this.subkey]:e;(e=t?!!e:e)!==this.state&&((this.state=e)?this.on_cb&&this.on_cb(e):this.off_cb&&this.off_cb(e))},a.prototype.setBool=function(e){return this.set(e,!0)},a.prototype.bind=function(e,t,n){var r=this;return Object.defineProperty(e,t,{get:function(){return r.state},set:function(e){return r.set(e,n)},configurable:!0,enumerable:!0}),this};var t=R.addClass,n=R.rmClass,r=R.contains;function o(e,t){var n=new Array(t);if(n.fill)n.fill(e);else for(var r=0;r<t;r++)n[r]=e;return n}function j(e,t){for(var n="";0<t--;)n+=e;return n}function m(e,t){for(var n,r=[e];n=r.shift();)for(var i=0;i<n.length;i++){var o=n[i];o&&o.nodeType==Node.ELEMENT_NODE&&(t(o),o.children&&0<o.children.length&&r.push(o.children))}}function f(n,r,i){var e=n.getBoundingClientRect(),o=e.width,a=e.height,l=u(function(){var e=n.getBoundingClientRect(),t=e.width,e=e.height;o==t&&a==e||(r(t,e,o,a),o=t,a=e,setTimeout(l,200))},100),t=null;var s=!1;var c=[];return i||m([n],function(e){var t=e.tagName;"none"!=(getComputedStyle(e).getPropertyValue("resize")||"")&&(i=!0),/^(?:img|video)$/i.test(t)?(e.addEventListener("load",l,!1),e.addEventListener("error",l,!1)):/^(?:details|summary)$/i.test(t)&&e.addEventListener("click",l,!1)}),i&&(t=setTimeout(function e(){t&&clearTimeout(t),s||(t=setTimeout(e,200)),l()},200)),{check:l,stop:function(){s=!0,l.stop(),t&&(clearTimeout(t),t=null);for(var e=0;e<c.length;e++)c[e][0].removeEventListener(c[e][1],l,!1)}}}function i(e){return"function"==typeof Symbol?Symbol(e):"_\n"+e+"\n_"+Math.floor(65535*Math.random()).toString(16)}var l="__hypermd__",s={lineNumbers:!0,lineWrapping:!0,theme:"hypermd-light",mode:"text/x-hypermd",tabSize:4,autoCloseBrackets:!0,foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter","HyperMD-goback"]},c={theme:"default"};function h(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,r=0;r<n.length;r++)if((t-=n[r].size)<0)return r}function b(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[h(e,t)];e=e.display.externalMeasured;return e&&t>=e.lineN&&t<e.lineN+e.size?e:void 0}function _(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache,before:!1};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!1};for(var i=0;i<e.rest.length;i++)if(e.rest[i].lineNo()>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}function I(e){this.cm=e}var p=Object.freeze({findViewIndex:h,findViewForLine:b,mapFromLineView:_});function v(e,t,n){for(var r=t.line,i={line:r,ch:0},o={line:r,ch:t.ch},a="function"==typeof n&&n,l=!a&&new RegExp("(?:^|\\s)"+n+"(?:\\s|$)"),s=e.getLineTokens(r),c=0;c<s.length&&!(s[c].end>=t.ch);c++);if(c===s.length)return null;for(var d=c;d<s.length;d++){var h=s[d];if(a?!a(h):!l.test(h.type))break;o.ch=h.end}for(d=c;0<=d;d--){h=s[d];if(!(a?a(h):l.test(h.type))){i.ch=h.end;break}}return{from:i,to:o}}function g(e){return"anchor"in e&&(e=[e.head,e.anchor]),0<R.cmpPos(e[0],e[1])?[e[1],e[0]]:[e[0],e[1]]}function k(e,t){var n=e[0],r=e[1],e=t[0],t=t[1];return!(R.cmpPos(r,e)<0||0<R.cmpPos(n,t))}I.prototype.findNext=function(n,e,r){var i,o=this.lineNo,a=this.lineTokens,l=null,s=this.i_token+1,t=!1;if(!0===e?t=!0:"number"==typeof e&&(s=e),r)if(r.line>o)s=a.length;else if(!(r.line<o))for(;s<a.length&&!(a[s].start>=r.ch);s++);for(;s<a.length;s++){var c=a[s];if("function"==typeof n?n(c,a,s):n.test(c.type)){l=c;break}}return!l&&t&&(i=this.cm,t=Math.max(r?r.line:0,o+1),i.eachLine(t,i.lastLine()+1,function(e){if(o=e.lineNo(),a=i.getLineTokens(o),s=0,r&&o===r.line)for(;s<a.length&&!(a[s].start>=r.ch);s++);for(;s<a.length;s++){var t=a[s];if("function"==typeof n?n(t,a,s):n.test(t.type))return l=t,!0}})),l?{lineNo:o,token:l,i_token:s}:null},I.prototype.findPrev=function(e,t,n){var r=this.lineNo,i=this.lineTokens,o=null,a=this.i_token-1,l=!1;if(!0===t?l=!0:"number"==typeof t&&(a=t),n)if(n.line<r)a=-1;else if(!(n.line>r))for(;a<i.length&&!(i[a].start>=n.ch);a++);for(a>=i.length&&(a=i.length-1);0<=a;a--){var s=i[a];if("function"==typeof e?e(s,i,a):e.test(s.type)){o=s;break}}if(!o&&l)for(var c=this.cm,l=Math.min(n?n.line:c.lastLine(),r-1),d=c.firstLine(),r=l+1;!o&&d<=--r;){c.getLineHandle(r);i=c.getLineTokens(r),a=0;if(n&&r===n.line)for(;a<i.length&&!(i[a].start>=n.ch);a++);for(a>=i.length&&(a=i.length-1);0<=a;a--){s=i[a];if("function"==typeof e?e(s,i,a):e.test(s.type)){o=s;break}}}return o?{lineNo:r,token:o,i_token:a}:null},I.prototype.expandRange=function(t,e){for(var n=this.cm,r="function"==typeof t?t:("string"==typeof t&&(t=new RegExp("(?:^|\\s)"+t+"(?:\\s|$)")),function(e){return!!e&&t.test(e.type||"")}),i={lineNo:this.lineNo,i_token:this.i_token,token:this.lineTokens[this.i_token]},o=Object.assign({},i),a=!1,l=this.lineTokens,s=this.i_token;!a;){for(s>=l.length&&(s=l.length-1);0<=s;s--){var c=l[s];if(!r(c,l,s)){a=!0;break}i.i_token=s,i.token=c}if(a||!(e&&i.lineNo>n.firstLine()))break;s=(l=n.getLineTokens(--i.lineNo)).length-1}for(a=!1,l=this.lineTokens,s=this.i_token;!a;){for(s<0&&(s=0);s<l.length;s++){var d=l[s];if(!r(d,l,s)){a=!0;break}o.i_token=s,o.token=d}if(a||!(e&&o.lineNo<n.lastLine()))break;l=n.getLineTokens(++o.lineNo),s=0}return{from:i,to:o}},I.prototype.setPos=function(e,t,n){void 0===t?(t=e,e=this.line):"number"==typeof e&&(e=this.cm.getLineHandle(e));var r=e===this.line,i=0;n||!r?(this.line=e,this.lineNo=e.lineNo(),this.lineTokens=this.cm.getLineTokens(this.lineNo)):(i=this.i_token,this.lineTokens[i].start>t&&(i=0));for(var o=this.lineTokens;i<o.length&&!(o[i].end>t);i++);this.i_token=i},I.prototype.getToken=function(e){return"number"!=typeof e&&(e=this.i_token),this.lineTokens[e]},I.prototype.getTokenType=function(e){"number"!=typeof e&&(e=this.i_token);e=this.lineTokens[e];return e&&e.type||""};function y(e){var n=this;this.cm=e,this.caches=new Array,e.on("change",function(e,t){t=t.from.line;n.caches.length>t&&n.caches.splice(t)})}y.prototype.getTokenTypes=function(e,t){var n=t?t.state:{},t=e.state,e=" "+e.type+" ";return{em:t.em?1:n.em?2:0,strikethrough:t.strikethrough?1:n.strikethrough?2:0,strong:t.strong?1:n.strong?2:0,code:t.code?1:n.code?2:0,linkText:t.linkText?3===t.hmdLinkType||6===t.hmdLinkType?1:0:n.linkText?2:0,linkHref:t.linkHref&&!t.linkText?1:t.linkHref||t.linkText||!n.linkHref||n.linkText?0:2,task:-1!==e.indexOf(" formatting-task ")?3:0,hashtag:t.hmdHashtag?1:n.hmdHashtag?2:0}},y.prototype.extract=function(e,t){if(!t){t=this.caches[e];if(t)return t}for(var n=this.cm.getLineTokens(e),r=this.cm.getLine(e),i=r.length,o=[],a={},l=0;l<n.length;l++){var s,c=n[l],d=this.getTokenTypes(c,n[l-1]);for(s in d){var h=a[s];1&d[s]&&(h||(h={type:s,begin:c.start,end:i,head:c,head_i:l,tail:n[n.length-1],tail_i:n.length-1,text:r.slice(c.start)},o.push(h),a[s]=h)),2&d[s]&&h&&(h.tail=c,h.tail_i=l,h.end=c.end,h.text=h.text.slice(0,h.end-h.begin),a[s]=null)}}return this.caches[e]=o},y.prototype.findSpansAt=function(e){for(var t=this.extract(e.line),n=e.ch,r=[],i=0;i<t.length;i++){var o=t[i];if(o.begin>n)break;n>=o.begin&&o.end>=n&&r.push(o)}return r},y.prototype.findSpanWithTypeAt=function(e,t){for(var n=this.extract(e.line),r=e.ch,i=0;i<n.length;i++){var o=n[i];if(o.begin>r)break;if(r>=o.begin&&o.end>=r&&o.type===t)return o}return null};var w=i("LineSpanExtractor");function T(e){return w in e?e[w]:e[w]=new y(e)}function x(r,i,o){return function(e){if(e.hmd||(e.hmd={}),e.hmd[r])return e.hmd[r];var t=new i(e);if(e.hmd[r]=t,o)for(var n in o)t[n]=o[n];return t}}var L=Object.freeze({Addon:function(e){},Getter:x}),F=/[^\\][$|]/,P=/^(?:[*\-+]|^[0-9]+([.)]))\s+/,q=/^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\.beep|\.lwz|\.xpc|\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\.beeps?|xmpp|xri|ymsgr|z39\.50[rs]?):(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]|\([^\s()<>]*\))+(?:\([^\s()<>]*\)|[^\s`*!()\[\]{};:'".,<>?Â«Â»â€œâ€â€˜â€™]))/i,$=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,z=/^\.{0,2}\/[^\>\s]+/,K=/^(?:[-()/a-zA-Z0-9ã‚¡-ãƒºãƒ¼-ãƒ¾ï½¦-ï¾Ÿï½°ï¼-ï¼™ï¼¡-ï¼ºï½-ï½šã-ã‚–ã‚™-ã‚ãƒ¼ã€…ã-ã‚“ã‚¡-ãƒ¾ä¸€-\u9FEFã€-ä¶µï¨ï¨ï¨‘ï¨“ï¨”ï¨Ÿï¨¡ï¨£ï¨¤ï¨§-ï¨©]|[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d])+/,U=/^\s*[^\|].*?\|.*[^|]\s*$/,W=/^\s*[^\|].*\|/,B=/^\s*\|[^\|]+\|.+\|\s*$/,X=/^\s*\|/,Y={};function G(e){e.hmdTable=0,e.hmdTableColumns=[],e.hmdTableID=null,e.hmdTableCol=e.hmdTableRow=0}Y[1]="hmd-barelink",Y[6]="hmd-barelink2",Y[2]="hmd-barelink hmd-footref",Y[4]="hmd-footnote line-HyperMD-footnote",Y[7]="hmd-footref2";var V=/^\s+((\d+[).]|[-*+])\s+)?/,M={hr:"line-HyperMD-hr line-background-HyperMD-hr-bg hr",list1:"list-1",list2:"list-2",list3:"list-3",code:"inline-code",hashtag:"hashtag meta"};R.defineMode("hypermd",function(C,e){var H={front_matter:!0,math:!0,table:!0,toc:!0,orgModeMarkup:!0,hashtag:!1,fencedCodeBlockHighlighting:!0,name:"markdown",highlightFormatting:!0,taskLists:!0,strikethrough:!0,emoji:!0,tokenTypeOverrides:M};Object.assign(H,e),H.tokenTypeOverrides!==M&&(H.tokenTypeOverrides=Object.assign({},M,H.tokenTypeOverrides)),H.name="markdown";var S={htmlBlock:null},E=R.getMode(C,H),e=Object.assign({},E);function o(e,t){var n=t.hmdInnerExitChecker(e,t),r=t.hmdInnerStyle,i=(!n||!n.skipInnerMode)&&t.hmdInnerMode.token(e,t.hmdInnerState)||"";return r&&(i+=" "+r),n&&(n.style&&(i+=" "+n.style),n.endPos&&(e.pos=n.endPos),t.hmdInnerExitChecker=null,t.hmdInnerMode=null,t.hmdInnerState=null,t.hmdOverride=null),i.trim()||null}function D(n){return{token:function(e){var t=e.string.indexOf(n,e.start);return-1===t?e.skipToEnd():0===t?e.pos+=n.length:(e.pos=t,"\\"===e.string.charAt(t-1)&&e.pos++),null}}}function N(n,r){return r=r||{},function(e,t){return e.string.substr(e.start,n.length)===n?(r.endPos=e.start+n.length,r):null}}function A(e,t,n,r){if("string"==typeof n&&(n=R.getMode(C,n)),!(n&&"null"!==n.name||(n="endTag"in r?D(r.endTag):"function"==typeof r.fallbackMode&&r.fallbackMode())))throw new Error("no mode");t.hmdInnerExitChecker="endTag"in r?N(r.endTag):r.exitChecker,t.hmdInnerStyle=r.style,t.hmdInnerMode=n,t.hmdOverride=o,t.hmdInnerState=R.startState(n);var i=r.style||"";return r.skipFirstToken||(i+=" "+n.token(e,t.hmdInnerState)),i.trim()}return e.startState=function(){var e=E.startState();return G(e),e.hmdOverride=null,e.hmdInnerExitChecker=null,e.hmdInnerMode=null,e.hmdLinkType=0,e.hmdNextMaybe=H.front_matter?1:0,e.hmdNextState=null,e.hmdNextStyle=null,e.hmdNextPos=null,e.hmdHashtag=0,e},e.copyState=function(e){for(var t=E.copyState(e),n=0,r=["hmdLinkType","hmdNextMaybe","hmdTable","hmdTableID","hmdTableCol","hmdTableRow","hmdOverride","hmdInnerMode","hmdInnerStyle","hmdInnerExitChecker","hmdNextPos","hmdNextState","hmdNextStyle","hmdHashtag"];n<r.length;n+=1){var i=r[n];t[i]=e[i]}return t.hmdTableColumns=e.hmdTableColumns.slice(0),e.hmdInnerMode&&(t.hmdInnerState=R.copyState(e.hmdInnerMode,e.hmdInnerState)),t},e.blankLine=function(e){var t,n=e.hmdInnerMode;return n?n.blankLine&&(t=n.blankLine(e.hmdInnerState)):t=E.blankLine(e),t=t||"",-1===e.code&&(t+=" line-HyperMD-codeblock line-background-HyperMD-codeblock-bg"),G(e),t.trim()||null},e.indent=function(e,t){var n=e.hmdInnerMode||E,e=n.indent;return"function"==typeof e?e.apply(n,arguments):R.Pass},e.innerMode=function(e){return e.hmdInnerMode?{mode:e.hmdInnerMode,state:e.hmdInnerState}:E.innerMode(e)},e.token=function(e,t){if(t.hmdOverride)return t.hmdOverride(e,t);if(1===t.hmdNextMaybe){if("---"===e.string)return t.hmdNextMaybe=2,A(e,t,"yaml",{style:"hmd-frontmatter",fallbackMode:function(){return D("---")},exitChecker:function(e,t){return"---"===e.string?(t.hmdNextMaybe=0,{endPos:3}):null}});t.hmdNextMaybe=0}var n=t.f===S.htmlBlock,r=-1===t.code,i=0===e.start,o=t.linkText,a=t.linkHref,l=(m=!(r||n))&&!(t.code||t.indentedCode||t.linkHref),s="";if(m){if(H.math&&l&&(L=e.match(/^\${1,2}/,!1))){var c=L[0],d=c.length;if(2===d||e.string.slice(e.pos).match(/[^\\]\$/)){var h=R.getMode(C,{name:"stex"}),u="stex"!==h.name;return s+=A(e,t,h,{style:"math",skipFirstToken:u,fallbackMode:function(){return D(c)},exitChecker:N(c,{style:"formatting formatting-math formatting-math-end math-"+d})}),u&&(e.pos+=L[0].length),s+=" formatting formatting-math formatting-math-begin math-"+d}}if(i&&H.orgModeMarkup&&(L=e.match(/^\#\+(\w+\:?)\s*/)))return e.eol()||(t.hmdOverride=function(e,t){return e.skipToEnd(),t.hmdOverride=null,"string hmd-orgmode-markup"}),"meta formatting-hmd-orgmode-markup hmd-orgmode-markup line-HyperMD-orgmode-markup";if(i&&H.toc&&e.match(/^\[TOCM?\]\s*$/i))return"meta line-HyperMD-toc hmd-toc";if(l&&!t.hmdLinkType&&(e.match(q)||e.match($)))return"url"}t.hmdNextState?(e.pos=t.hmdNextPos,s+=" "+(t.hmdNextStyle||""),Object.assign(t,t.hmdNextState),t.hmdNextState=null,t.hmdNextStyle=null,t.hmdNextPos=null):s+=" "+(E.token(e,t)||""),0!==t.hmdHashtag&&(s+=" "+H.tokenTypeOverrides.hashtag),!S.htmlBlock&&t.htmlState&&(S.htmlBlock=t.f);var u=t.f===S.htmlBlock,d=-1===t.code,m=m&&!(u||d);(l=l&&m&&!(t.code||t.indentedCode||t.linkHref))&&(L=e.current().match(F))&&(e.pos=e.start+L.index+1);var f=e.current();if(u!=n&&(u?(s+=" hmd-html-begin",S.htmlBlock=t.f):s+=" hmd-html-end"),(r||d)&&(t.localMode&&r||(s=s.replace("inline-code","")),s+=" line-HyperMD-codeblock line-background-HyperMD-codeblock-bg",d!=r&&(d?r||(s+=" line-HyperMD-codeblock-begin line-background-HyperMD-codeblock-begin-bg"):s+=" line-HyperMD-codeblock-end line-background-HyperMD-codeblock-end-bg")),m){var p=t.hmdTable;if(i&&p&&((1==p?W:X).test(e.string)?(t.hmdTableCol=0,t.hmdTableRow++):G(t)),i&&t.header&&(/^(?:---+|===+)\s*$/.test(e.string)&&t.prevLine&&t.prevLine.header?s+=" line-HyperMD-header-line line-HyperMD-header-line-"+t.header:s+=" line-HyperMD-header line-HyperMD-header-"+t.header),t.indentedCode&&(s+=" hmd-indented-code"),t.quote){if(e.eol()&&(s+=" line-HyperMD-quote line-HyperMD-quote-"+t.quote,/^ {0,3}\>/.test(e.string)||(s+=" line-HyperMD-quote-lazy")),i&&(L=f.match(/^\s+/)))return e.pos=L[0].length,(s+=" hmd-indent-in-quote").trim();/^>\s+$/.test(f)&&">"!=e.peek()&&(e.pos=e.start+1,f=">",t.hmdOverride=function(e,t){return e.match(V),t.hmdOverride=null,"hmd-indent-in-quote line-HyperMD-quote line-HyperMD-quote-"+t.quote})}r=(t.listStack[t.listStack.length-1]||0)+3,m=i&&/^\s+$/.test(f)&&(!1!==t.list||e.indentation()<=r),r=t.list&&/formatting-list/.test(s);if(r||m&&(!1!==t.list||e.match(P,!1))){var g=t.listStack&&t.listStack.length||0;if(m){if(e.match(P,!1))!1===t.list&&g++;else{for(;0<g&&e.pos<t.listStack[g-1];)g--;if(!g)return s.trim()||null;s+=" line-HyperMD-list-line-nobullet line-HyperMD-list-line line-HyperMD-list-line-"+g}s+=" hmd-list-indent hmd-list-indent-"+g}else r&&(s+=" line-HyperMD-list-line line-HyperMD-list-line-"+g)}if(o!==t.linkText&&(o?(t.hmdLinkType in Y&&(s+=" "+Y[t.hmdLinkType]),4===t.hmdLinkType?t.hmdLinkType=5:t.hmdLinkType=0):(L=e.match(/^([^\]]+)\](\(| ?\[|\:)?/,!1))?L[2]?":"===L[2]?t.hmdLinkType=4:"["!==L[2]&&" ["!==L[2]||"]"!==e.string.charAt(e.pos+L[0].length)?t.hmdLinkType=3:t.hmdLinkType=6:"^"===L[1].charAt(0)?t.hmdLinkType=2:t.hmdLinkType=1:t.hmdLinkType=1),a!==t.linkHref&&(a?t.hmdLinkType&&(s+=" "+Y[t.hmdLinkType],t.hmdLinkType=0):"["===f&&"]"!==e.peek()&&(t.hmdLinkType=7)),0!==t.hmdLinkType&&(t.hmdLinkType in Y&&(s+=" "+Y[t.hmdLinkType]),5===t.hmdLinkType&&(/^(?:\]\:)?\s*$/.test(f)||(q.test(f)||z.test(f)?s+=" hmd-footnote-url":s=s.replace("string url",""),t.hmdLinkType=0))),/formatting-escape/.test(s)&&1<f.length){var b=f.length-1,_=s.replace("formatting-escape","escape")+" hmd-escape-char";return t.hmdOverride=function(e,t){return e.pos+=b,t.hmdOverride=null,_.trim()},s+=" hmd-escape-backslash",e.pos-=b,s}if(!s.trim()&&H.table){a=!1;if("|"===f.charAt(0)&&(e.pos=e.start+1,f="|",a=!0),a){if(!p){if(U.test(e.string)?p=1:B.test(e.string)&&(p=2),p){var v=e.lookAhead(1);if(2===p?B.test(v)?v=v.replace(/^\s*\|/,"").replace(/\|\s*$/,""):p=0:1===p&&(U.test(v)||(p=0)),p)for(var k=v.split("|"),y=0;y<k.length;y++){var w=k[y];if(/^\s*--+\s*:\s*$/.test(w))w="right";else if(/^\s*:\s*--+\s*$/.test(w))w="left";else if(/^\s*:\s*--+\s*:\s*$/.test(w))w="center";else{if(!/^\s*--+\s*$/.test(w)){p=0;break}w="default"}k[y]=w}}p&&(t.hmdTable=p,t.hmdTableColumns=k,t.hmdTableID="T"+e.lineOracle.line,t.hmdTableRow=t.hmdTableCol=0)}p&&(v=t.hmdTableColumns.length-1,2===p&&(0===t.hmdTableCol&&/^\s*\|$/.test(e.string.slice(0,e.pos))||e.match(/^\s*$/,!1))?s+=" hmd-table-sep hmd-table-sep-dummy":t.hmdTableCol<v&&(v=t.hmdTableRow,0==(T=t.hmdTableCol++)&&(s+=" line-HyperMD-table_"+t.hmdTableID+" line-HyperMD-table-"+p+" line-HyperMD-table-row line-HyperMD-table-row-"+v),s+=" hmd-table-sep hmd-table-sep-"+T))}}if(p&&1===t.hmdTableRow&&/emoji/.test(s)&&(s=""),l&&"<"===f){var T=null;if(e.match(/^\![A-Z]+/)?T=">":e.match("?")?T="?>":e.match("![CDATA[")&&(T="]]>"),null!=T)return A(e,t,null,{endTag:T,style:(s+" comment hmd-cdata-html").trim()})}if(H.hashtag&&l)switch(t.hmdHashtag){case 0:if("#"===f&&!t.linkText&&!t.image&&(i||/^\s*$/.test(e.string.charAt(e.start-1)))){var x=e.string.slice(e.pos).replace(/\\./g,"");if(L=K.exec(x))for(/^\d+$/.test(L[0])?t.hmdHashtag=0:t.hmdHashtag=1,x=x.slice(L[0].length);;){if("#"===x[0]&&(1===x.length||!K.test(x[1]))){t.hmdHashtag=2;break}if(!(L=x.match(/^\s+/))||!(L=(x=x.slice(L[0].length)).match(K)))break;x=x.slice(L[0].length)}t.hmdHashtag&&(s+=" formatting formatting-hashtag hashtag-begin "+H.tokenTypeOverrides.hashtag)}break;case 1:var L,M,O=!1;/formatting/.test(s)||/^\s*$/.test(f)||(L=f.match(K),0<(M=f.length-(L?L[0].length:0))&&(e.backUp(M),O=!0)),(O=(O=O||e.eol())||!K.test(e.peek()))&&(s+=" hashtag-end",t.hmdHashtag=0);break;case 2:"#"===f&&(s=s.replace(/\sformatting-header(?:-\d+)?/g,""),s+=" formatting formatting-hashtag hashtag-end",t.hmdHashtag=0)}}return s.trim()||null},e},"hypermd"),R.defineMIME("text/x-hypermd","hypermd");var O=Object.freeze({});var C={byDrop:!1,byPaste:!1,fileHandler:null},H={byPaste:!0,byDrop:!0};s.hmdInsertFile=H,R.defineOption("hmdInsertFile",C,function(e,t){var n;t&&"boolean"!=typeof t?"function"==typeof t&&(t={byDrop:!0,byPaste:!0,fileHandler:t}):t={byDrop:n=!!t,byPaste:n};var r,i=E(e);for(r in C)i[r]=(r in t?t:C)[r]});var S=function(e){var o=this;this.cm=e,this.pasteHandle=function(e,t){o.doInsert(t.clipboardData||window.clipboardData,!0)&&t.preventDefault()},this.dropHandle=function(t,n){var r=o,t=o.cm,i=!1;t.operation(function(){var e=t.coordsChar({left:n.clientX,top:n.clientY},"window");t.setCursor(e),i=r.doInsert(n.dataTransfer,!1)}),i&&n.preventDefault()},new a(function(){return o.cm.on("paste",o.pasteHandle)},function(){return o.cm.off("paste",o.pasteHandle)}).bind(this,"byPaste",!0),new a(function(){return o.cm.on("drop",o.dropHandle)},function(){return o.cm.off("drop",o.dropHandle)}).bind(this,"byDrop",!0)};S.prototype.doInsert=function(e,t){var o=this.cm;if(t&&e.types&&e.types.some(function(e){return"text/"===e.slice(0,5)}))return!1;if(!e||!e.files||0===e.files.length)return!1;var r=e.files,a=this.fileHandler,l=!1;return"function"==typeof a&&(o.operation(function(){o.replaceSelection(".");var e=o.getCursor(),t={line:e.line,ch:e.ch-1},n=document.createElement("span"),i=o.markText(t,e,{replacedWith:n,clearOnEnter:!1,handleMouseEvents:!1});(l=a(r,{marker:i,cm:o,finish:function(n,r){return o.operation(function(){var e=i.find(),t=e.from,e=e.to;o.replaceRange(n,t,e),i.clear(),"number"==typeof r&&o.setCursor({line:t.line,ch:t.ch+r})})},setPlaceholder:function(e){0<n.childNodes.length&&n.removeChild(n.firstChild),n.appendChild(e),i.changed()},resize:function(){i.changed()}}))||i.clear()}),l)};var E=x("InsertFile",S,C),D=Object.freeze({ajaxUpload:function(e,t,n,r){var i,o=new XMLHttpRequest,a=new FormData;for(i in t)a.append(i,t[i]);o.onreadystatechange=function(){if(4==this.readyState){var e=o.responseText;try{e=JSON.parse(o.responseText)}catch(e){}/^20\d/.test(o.status+"")?n(e,null):n(null,e)}},o.open(r||"POST",e,!0),o.send(a)},defaultOption:C,suggestedOption:H,InsertFile:S,getAddon:E});function N(e){var t=e=e.trim(),n="",e=e.match(/^(\S+)\s+("(?:[^"\\]+|\\.)+"|[^"\s].*)/);return e&&(t=e[1],'"'===(n=e[2]).charAt(0)&&(n=n.substr(1,n.length-2).replace(/\\"/g,'"'))),{url:t,title:n}}var A,Z={hmdReadLink:function(e,t){return te(this).read(e,t)},hmdResolveURL:function(e,t){return te(this).resolve(e,t)},hmdSplitLink:N};for(A in Z)R.defineExtension(A,Z[A]);var Q={baseURI:""},J={baseURI:""};s.hmdReadLink=J,R.defineOption("hmdReadLink",Q,function(e,t){t&&"string"!=typeof t||(t={baseURI:t});var n,r=te(e);for(n in Q)r[n]=(n in t?t:Q)[n]});var ee=function(e){var t=this;this.cm=e,this.cache={},e.on("changes",u(function(){return t.rescan()},500)),this.rescan()};ee.prototype.read=function(e,t){var n,r=this.cache[e.trim().toLowerCase()]||[];"number"!=typeof t&&(t=1e9);for(var i=0;i<r.length&&!((n=r[i]).line>t);i++);return n},ee.prototype.rescan=function(){var e=this.cm,r=this.cache={};e.eachLine(function(e){var t=e.text,n=/^(?:>\s+)*>?\s{0,3}\[([^\]]+)\]:\s*(.+)$/.exec(t);n&&(t=n[1].trim().toLowerCase(),n=n[2],r[t]||(r[t]=[]),r[t].push({line:e.lineNo(),content:n}))})},ee.prototype.resolve=function(e,t){var n,r=/^(?:[\w-]+\:\/*|\/\/)[^\/]+/,i=/\/[^\/]+(?:\/+\.?)*$/;if(!e)return e;if(/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e))return"mailto:"+e;var o="";if(!(t=t||this.baseURI)||r.test(e))return e;for((n=t.match(r))&&(o=n[0],t=t.slice(o.length));n=e.match(/^(\.{1,2})([\/\\]+)/);)e=e.slice(n[0].length),".."==n[1]&&(t=t.replace(i,""));return e="/"===e.charAt(0)&&o?o+e:(/\/$/.test(t)||(t+="/"),o+t+e)};var te=x("ReadLink",ee,Q),ne=Object.freeze({splitLink:N,Extensions:Z,defaultOption:Q,suggestedOption:J,ReadLink:ee,getAddon:te}),re="function"==typeof marked?marked:function(e){return"<pre>"+(e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/  /g," &nbsp;"))+"</pre>"};function ie(e,t){return t?re(t):null}var oe={enabled:!1,xOffset:10,convertor:ie},ae={enabled:!0};s.hmdHover=ae,R.defineOption("hmdHover",oe,function(e,t){t&&"boolean"!=typeof t?"function"==typeof t&&(t={enabled:!0,convertor:t}):t={enabled:!!t};var n,r=de(e);for(n in oe)r[n]=(n in t?t:oe)[n]});var le=function(e){var t=this;this.cm=e,new a(function(){n.addEventListener("mouseenter",o,!0)},function(){n.removeEventListener("mouseenter",o,!0),t.hideInfo()}).bind(this,"enabled",!0);var n=e.display.lineDiv;this.lineDiv=n;var r=document.createElement("div"),i=document.createElement("div"),e=document.createElement("div");r.setAttribute("style","position:absolute;z-index:99"),r.setAttribute("class","HyperMD-hover"),r.setAttribute("cm-ignore-events","true"),i.setAttribute("class","HyperMD-hover-content"),r.appendChild(i),e.setAttribute("class","HyperMD-hover-indicator"),r.appendChild(e),this.tooltipDiv=r,this.tooltipContentDiv=i,this.tooltipIndicator=e;var o=this.mouseenter.bind(this)};le.prototype.mouseenter=function(e){var t,n,r=this.cm,i=e.target,o=i.className;i==this.tooltipDiv||i.compareDocumentPosition&&8==(8&i.compareDocumentPosition(this.tooltipDiv))||("SPAN"===i.nodeName&&(n=o.match(/(?:^|\s)cm-(hmd-barelink2?|hmd-footref2)(?:\s|$)/))?(t=r.coordsChar({left:e.clientX,top:e.clientY},"window"),e=o=null,(n=v(r,t,n[1]))&&(o=(o=r.getRange(n.from,n.to)).slice(1,-1))&&(e=r.hmdReadLink(o,t.line)||null),(e=(this.convertor||ie)(o,e&&e.content||null))?this.showInfo(e,i):this.hideInfo()):this.hideInfo())},le.prototype.showInfo=function(e,t){var n=t.getBoundingClientRect(),r=this.lineDiv.getBoundingClientRect(),i=this.tooltipDiv,t=this.xOffset;this.tooltipContentDiv.innerHTML=e,i.style.left=n.left-r.left-t+"px",this.lineDiv.appendChild(i);e=i.getBoundingClientRect();e.right>r.right&&(t=e.right-r.right,i.style.left=n.left-r.left-t+"px"),i.style.top=n.top-r.top-e.height+"px",this.tooltipIndicator.style.marginLeft=t+"px"},le.prototype.hideInfo=function(){this.tooltipDiv.parentElement==this.lineDiv&&this.lineDiv.removeChild(this.tooltipDiv)};function se(e,t){var n,r,i=e.text,o=e.type,a=e.url,l=e.pos;"url"!==o&&"link"!==o||((n=i.match(/\[[^\[\]]+\](?:\[\])?$/))&&e.altKey?("[]"===(i=n[0]).slice(-2)&&(i=i.slice(0,-2)),o="footref"):(e.ctrlKey||e.altKey)&&a&&window.open(a,"_blank")),"todo"===o&&(n=(r=v(t,l,"formatting-task")).from,a=r.to,r="[ ]"===(r=t.getRange(n,a))?"[x]":"[ ]",t.replaceRange(r,n,a)),"footref"===o&&(e.ctrlKey||e.altKey)&&(i=i.slice(1,-1),(i=t.hmdReadLink(i,l.line))&&(ue(t,i.line,l),t.setCursor({line:i.line,ch:0})))}var ce,de=x("Hover",le,oe),he=Object.freeze({defaultConvertor:ie,defaultOption:oe,suggestedOption:ae,Hover:le,getAddon:de}),ue=function(e,t,n){var r,i=function(e){if(!(-1!=e.options.gutters.indexOf("HyperMD-goback")))return null;var t=document.createElement("div");t.className="HyperMD-goback-button",t.addEventListener("click",function(){e.setCursor(ce.find()),e.clearGutter("HyperMD-goback"),ce.clear(),ce=null});var n=e.display.gutters.children;return n=(n=n[n.length-1]).offsetLeft+n.offsetWidth,t.style.width=n+"px",t.style.marginLeft=-n+"px",t}(e);i&&(i.innerHTML=n.line+1+"",r=e,n=n,ce&&(r.clearGutter("HyperMD-goback"),ce.clear()),ce=r.setBookmark(n),e.setGutterMarker(t,"HyperMD-goback",i))},me={enabled:!1,handler:ce=null},fe={enabled:!0};s.hmdClick=fe,R.defineOption("hmdClick",me,function(e,t){t&&"boolean"!=typeof t?"function"==typeof t&&(t={enabled:!0,handler:t}):t={enabled:!!t};var n,r=ge(e);for(n in me)r[n]=(n in t?t:me)[n]});var pe=function(e){var b=this;this.cm=e,this._mouseMove_keyDetect=function(e){var t=b.el,n=t.className,r=n,i="HyperMD-with-alt",o="HyperMD-with-ctrl";!e.altKey&&0<=n.indexOf(i)&&(r=n.replace(i,"")),!e.ctrlKey&&0<=n.indexOf(o)&&(r=n.replace(o,"")),e.altKey||e.ctrlKey||(b._KeyDetectorActive=!1,t.removeEventListener("mousemove",b._mouseMove_keyDetect,!1)),n!=r&&(t.className=r.trim())},this._keyDown=function(e){var t=e.keyCode||e.which,e=18==t?"HyperMD-with-alt":17==t?"HyperMD-with-ctrl":"",t=b.el;e&&-1==t.className.indexOf(e)&&(t.className+=" "+e),b._KeyDetectorActive||(b._KeyDetectorActive=!0,b.el.addEventListener("mousemove",b._mouseMove_keyDetect,!1))},this._mouseUp=function(e){var t=b._cinfo;b.lineDiv.removeEventListener("mouseup",b._mouseUp,!1),5<Math.abs(e.clientX-t.clientX)||5<Math.abs(e.clientY-t.clientY)||"function"==typeof b.handler&&!1===b.handler(t,b.cm)||se(t,b.cm)},this._mouseDown=function(e){var t,n,r,i,o,a,l,s,c,d=e.button,h=e.clientX,u=e.clientY,m=e.ctrlKey,f=e.altKey,p=e.shiftKey,g=b.cm;"PRE"!==e.target.tagName&&(t=g.coordsChar({left:h,top:u},"window"),r=(s=g.getTokenAt(t)).state,o=null,(e=(i=" "+s.type+" ").match(/\s(image|link|url)\s/))?(o=e[1],s=/\shmd-barelink\s/.test(i),r.linkText?(n=v(g,t,function(e){return e.state.linkText||/(?:\s|^)link(?:\s|$)/.test(e.type)}),o="link"):n=v(g,t,o),!/^(?:image|link)$/.test(o)||s||(a=v(g,{line:t.line,ch:n.to.ch+1},"url"))&&(n.to=a.to),")"===(a=g.getRange(n.from,n.to).trim()).slice(-1)&&-1!==(l=a.lastIndexOf("]("))?c=N(a.slice(l+2,-1)).url:(e=a.match(/[^\\]\]\s?\[([^\]]+)\]$/))||(e=a.match(/^\[(.+)\]\s?\[\]$/))||(e=a.match(/^\[(.+)\](?:\:\s*)?$/))?(s&&"^"===e[1].charAt(0)&&(o="footref"),c=(s=g.hmdReadLink(e[1],t.line))?N(s.content).url:null):((e=a.match(/^\<(.+)\>$/))||(e=a.match(/^\((.+)\)$/))||(e=[null,a]))&&(c=e[1]),c=g.hmdResolveURL(c)):i.match(/\sformatting-task\s/)?(o="todo",(n=v(g,t,"formatting-task")).to.ch=g.getLine(t.line).length,a=g.getRange(n.from,n.to),c=null):i.match(/\shashtag/)&&(n=v(g,t,o="hashtag"),a=g.getRange(n.from,n.to),c=null),null!==o&&(b._cinfo={type:o,text:a,url:c,pos:t,button:d,clientX:h,clientY:u,ctrlKey:m,altKey:f,shiftKey:p},b.lineDiv.addEventListener("mouseup",b._mouseUp,!1)))},this.lineDiv=e.display.lineDiv;var t=this.el=e.getWrapperElement();new a(function(){b.lineDiv.addEventListener("mousedown",b._mouseDown,!1),t.addEventListener("keydown",b._keyDown,!1)},function(){b.lineDiv.removeEventListener("mousedown",b._mouseDown,!1),t.removeEventListener("keydown",b._keyDown,!1)}).bind(this,"enabled",!0)},ge=x("Click",pe,me),be=Object.freeze({defaultClickHandler:se,defaultOption:me,suggestedOption:fe,Click:pe,getAddon:ge}),_e={enabled:!1,convertor:null},ve={enabled:!0};s.hmdPaste=ve,R.defineOption("hmdPaste",_e,function(e,t){t&&"boolean"!=typeof t?"function"==typeof t&&(t={enabled:!0,convertor:t}):t={enabled:!!t};var n,r=we(e);for(n in _e)r[n]=(n in t?t:_e)[n]});var ke,ye=function(e){var i=this;this.cm=e,this.pasteHandler=function(e,t){var n=t.clipboardData||window.clipboardData,r=i.convertor;r&&n&&-1!=n.types.indexOf("text/html")&&((n=r(n.getData("text/html")))&&(e.operation(e.replaceSelection.bind(e,n)),t.preventDefault()))},new a(function(){e.on("paste",i.pasteHandler)},function(){e.off("paste",i.pasteHandler)}).bind(this,"enabled",!0)},we=x("Paste",ye,_e),Te=Object.freeze({defaultOption:_e,suggestedOption:ve,Paste:ye,getAddon:we}),xe="undefined"==typeof Uint8Array?Array:Uint8Array;(Ke=ke=ke||{}).OK="ok",Ke.CURSOR_INSIDE="ci",Ke.HAS_MARKERS="hm";var Le={};function Me(e,t,n,r){var i=Le;if(e in i&&!r)throw new Error("Folder "+e+" already registered");Ce[e]=!1,He[e]=!!n,i[e]=t}function Oe(t,n,r){t.operation(function(){var e={line:(e=n.find().from).line,ch:e.ch+~~r};t.setCursor(e),t.focus(),n.clear()})}var Ce={},He={};s.hmdFold=He,c.hmdFold=!1,R.defineOption("hmdFold",Ce,function(e,t){"customFolders"in(t=!t||"boolean"==typeof t?t?He:Ce:t)&&(console.error("[HyperMD][Fold] `customFolders` is removed. To use custom folders, `registerFolder` first."),delete t.customFolders);var n,r=Ee(e);for(n in Le)r.setStatus(n,t[n])});var Se=function(t){function e(e){var h=this;t.call(this,e),this.cm=e,this._enabled={},this.folded={},this.startFold=u(this.startFoldImmediately.bind(this),100),this._quickFoldHint=[],e.on("changes",function(e,t){for(var n=[],r=0,i=t;r<i.length;r+=1)for(var o=i[r],a=0,l=e.findMarks(o.from,o.to);a<l.length;a+=1){var s=l[a];s._hmd_fold_type&&n.push(s)}for(var c=0,d=n;c<d.length;c+=1)d[c].clear();h.startFold()}),e.on("cursorActivity",function(c){var e,d={};function t(e){var t=e.line;if(t in d)d[t].ch.push(e.ch);else{for(var n=c.getLineHandle(e.line),r=n.markedSpans||[],i=[],o=0;o<r.length;o++){var a,l,s=r[o].marker;"_hmd_crange"in s&&(a=s._hmd_crange[0].line<t?0:s._hmd_crange[0].ch,l=s._hmd_crange[1].line>t?n.text.length:s._hmd_crange[1].ch,i.push([s,a,l]))}d[t]={lineNo:t,ch:[e.ch],markers:i}}}for(e in c.listSelections().forEach(function(e){t(e.anchor),t(e.head)}),d){var n=d[e];if(n.markers.length)for(var r=0;r<n.ch.length;r++)for(var i=n.ch[r],o=0;o<n.markers.length;o++){var a=n.markers[o],l=a[0],s=a[1],a=a[2];s<=i&&i<=a&&(l.clear(),n.markers.splice(o,1),o--)}}h.startQuickFold()})}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.setStatus=function(e,t){e in Le&&!this._enabled[e]!=!t&&(this._enabled[e]=!!t,t?this.startFold():this.clear(e))},e.prototype.requestRange=function(e,t,n,r){r=r||t,n=n||e;var i=this.cm;if(0!==i.findMarks(e,t).length)return ke.HAS_MARKERS;this._quickFoldHint.push(e.line),this._lastCRange=[n,r];for(var o=i.listSelections(),a=0;a<o.length;a++){var l=g(o[a]);if(k(this._lastCRange,l)||k([e,t],l))return ke.CURSOR_INSIDE}return this._quickFoldHint.push(n.line),ke.OK},e.prototype.startFoldImmediately=function(e,t){var v=this,n=this.cm;e=e||n.firstLine(),t=(t||n.lastLine())+1,this._quickFoldHint=[],this.setPos(e,0,!0),n.operation(function(){return n.eachLine(e,t,function(e){var t=e.lineNo();if(!(t<v.lineNo)){t>v.lineNo&&v.setPos(t,0);var n=new xe(e.text.length),r=e.markedSpans;if(r)for(var i=0;i<r.length;++i)for(var o=r[i],a=null==o.from?0:o.from,l=null==o.to?n.length:o.to,s=a;s<l;s++)n[s]=1;for(var c=v.lineTokens;v.i_token<c.length;){for(var d,h=c[v.i_token],u=null,m=!0,f=h.start;f<h.end;f++)if(n[f]){m=!1;break}if(m)for(d in Le)if(v._enabled[d]&&(u=Le[d](v,h)))break;if(u){var p=u.find(),g=p.from,p=p.to;if((v.folded[d]||(v.folded[d]=[])).push(u),u._hmd_fold_type=d,u._hmd_crange=v._lastCRange,u.on("clear",function(e,t){var n,r=v.folded[d];r&&-1!==(n=r.indexOf(u))&&r.splice(n,1),v._quickFoldHint.push(e.line)}),g.line>t||g.ch>h.start){v.i_token++;for(var g=g.line===t?g.ch:n.length,b=p.line===t?p.ch:n.length,_=g;_<b;_++)n[_]=1}else{if(p.line!==t)return void v.setPos(p.line,p.ch);v.setPos(p.ch)}}else v.i_token++}}})})},e.prototype.startQuickFold=function(){var e=this._quickFoldHint;if(0!==e.length){for(var t=e[0],n=t,r=0,i=e;r<i.length;r+=1){var o=i[r];o<t&&(t=o),n<o&&(n=o)}this.startFold.stop(),this.startFoldImmediately(t,n)}},e.prototype.clear=function(e){this.startFold.stop();var t,n=this.folded[e];if(n&&n.length)for(;t=n.pop();)t.clear()},e.prototype.clearAll=function(){for(var e in this.startFold.stop(),this.folded)for(var t,n=this.folded[e];t=n.pop();)t.clear()},e}(I),Ee=x("Fold",Se),H=Object.freeze({get RequestRangeResult(){return ke},folderRegistry:Le,registerFolder:Me,breakMark:Oe,defaultOption:Ce,suggestedOption:He,Fold:Se,getAddon:Ee}),S=function(e,t){var n=e.cm,r=/\bformatting-link-string\b/;if(/\bimage-marker\b/.test(t.type)&&"!"===t.string){var i=e.lineNo,o=e.findNext(r),a=e.findNext(r,o.i_token+1),r={line:i,ch:t.start},t={line:i,ch:a.token.end},e=e.requestRange(r,t,r,r);if(e===ke.OK){e=n.getRange({line:i,ch:o.token.start+1},{line:i,ch:a.token.start});if("]"===a.token.string){a=n.hmdReadLink(e,i);if(!a)return null;e=a.content}e=N(e).url;var e=n.hmdResolveURL(e),o=n.getRange({line:i,ch:r.ch+2},{line:i,ch:o.token.start-1}),l=document.createElement("img"),s=n.markText(r,t,{clearOnEnter:!0,collapsed:!0,replacedWith:l});return l.addEventListener("load",function(){l.classList.remove("hmd-image-loading"),s.changed()},!1),l.addEventListener("error",function(){l.classList.remove("hmd-image-loading"),l.classList.add("hmd-image-error"),s.changed()},!1),l.addEventListener("click",function(){return Oe(n,s)},!1),l.className="hmd-image hmd-image-loading",l.src=e,l.title=o,s}}return null};Me("image",S,!0);J=Object.freeze({ImageFolder:S}),ee=function(e,t){var n=e.cm;if("["!==t.string||!t.state.linkText||t.state.linkTitle||/\bimage\b/.test(t.type))return null;var r=T(n),i=r.findSpanWithTypeAt({line:e.lineNo,ch:t.start},"linkText");if(!i)return null;var o=r.findSpanWithTypeAt({line:e.lineNo,ch:i.end+1},"linkHref");if(!o)return null;t={line:e.lineNo,ch:o.begin},r={line:e.lineNo,ch:o.end},o={line:e.lineNo,ch:i.begin};if(e.requestRange(t,r,o,t)!==ke.OK)return null;i=n.getRange(t,r),e=N(i.substr(1,i.length-2)),o=e.url,i=e.title,e=document.createElement("span");e.setAttribute("class","hmd-link-icon"),e.setAttribute("title",o+"\n"+i),e.setAttribute("data-url",o);var a=n.markText(t,r,{collapsed:!0,replacedWith:e});return e.addEventListener("click",function(){return Oe(n,a)},!1),a};Me("link",ee,!0);var ae=Object.freeze({LinkFolder:ee}),De={};le=function(e,t){return 0===t.start&&t.type&&-1!==t.type.indexOf("HyperMD-codeblock-begin")&&/[-\w]+\s*$/.test(t.string)?Pe(e.cm).fold(e,t):null};Me("code",le,!0);var Ne={},Ae={};s.hmdFoldCode=Ae,R.defineOption("hmdFoldCode",Ne,function(e,t){t&&"boolean"!=typeof t||(t=t?Ae:Ne);var n,r=Pe(e);for(n in De)r.setStatus(n,t[n])});fe=function(e){this.cm=e,this._enabled={},this.folded={}};fe.prototype.setStatus=function(e,t){e in De&&!this._enabled[e]!=!t&&(this._enabled[e]=!!t,t?Ee(this.cm).startFold():this.clear(e))},fe.prototype.clear=function(e){var t,n=this.folded[e];if(n&&n.length)for(;t=n.pop();)t.marker.clear()},fe.prototype.fold=function(e,t){var n=this;if(0!==t.start||!t.type||-1===t.type.indexOf("HyperMD-codeblock-begin"))return null;var r,i,o=/([-\w]+)\s*$/.exec(t.string),a=o&&o[1].toLowerCase();if(!a)return null;var l,s=this.cm,c=De,d=this._enabled;for(l in c){var h=c[l];if(d[l]&&h.pattern(a)){i=l,r=h.renderer;break}}if(!i)return null;var t={line:e.lineNo,ch:0},u=null,m=s.lastLine(),f=e.lineNo+1;do{var p=s.getTokenAt({line:f,ch:1});if(p&&p.type&&-1!==p.type.indexOf("HyperMD-codeblock-end")){u={line:f,ch:p.end};break}}while(++f<m);if(!u)return null;if(e.requestRange(t,u)!==ke.OK)return null;var o=s.getRange({line:t.line+1,ch:0},{line:u.line,ch:0}),g={editor:s,lang:a,marker:null,lineWidget:null,el:null,break:Fe,changed:Fe},e=g.el=r(o,g);if(!e)return g.marker.clear(),null;o=document.createElement("div");o.className=Re+i,o.style.minHeight="1em",o.appendChild(e);var b=g.lineWidget=s.addLineWidget(u.line,o,{above:!1,coverGutter:!1,noHScroll:!1,showIfHidden:!1}),_=document.createElement("span");_.className=je+i,_.textContent="<CODE>";var v=g.marker=s.markText(t,u,{replacedWith:_});return o.addEventListener("mouseenter",function(){return _.className=Ie+i},!1),o.addEventListener("mouseleave",function(){return _.className=je+i},!1),g.changed=function(){b.changed()},g.break=function(){Oe(s,v)},_.addEventListener("click",g.break,!1),v.on("clear",function(){var e,t=n.folded[i];t&&-1!==(e=t.indexOf(g))&&t.splice(e,1),"function"==typeof g.onRemove&&g.onRemove(g),b.clear()}),i in this.folded?this.folded[i].push(g):this.folded[i]=[g],v};var Re="hmd-fold-code-content hmd-fold-code-",je="hmd-fold-code-stub hmd-fold-code-",Ie="hmd-fold-code-stub highlight hmd-fold-code-",Fe=function(){},Pe=x("FoldCode",fe,Ne),pe=Object.freeze({rendererRegistry:De,registerRenderer:function(t,e){if(t&&t.name&&t.renderer){var n,r=t.name,i=t.pattern,o=De;if(r in o&&!e)throw new Error("CodeRenderer "+r+" already exists");"string"==typeof i?(n=i.toLowerCase(),i=function(e){return e.toLowerCase()===n}):i instanceof RegExp&&(i=function(e){return t.pattern.test(e)});i={name:r,suggested:!!t.suggested,pattern:i,renderer:t.renderer};o[r]=i,Ne[r]=!1,Ae[r]=i.suggested}},CodeFolder:le,defaultOption:Ne,suggestedOption:Ae,FoldCode:fe,getAddon:Pe}),ve=function(e,t){var n=/formatting-math-begin\b/;if(!n.test(t.type))return null;var r=e.cm,i=e.lineNo,o=/math-2\b/.test(t.type),a=o?2:1;if(2==a&&1==t.string.length){0;var l=e.lineTokens[e.i_token+1];if(!l||!n.test(l.type))return null}l=e.findNext(/formatting-math-end\b/,o),i={line:i,ch:t.start},t=!1;if(l)c={line:l.lineNo,ch:l.token.start+a};else{if(!o)return null;var s=r.lastLine(),c={line:s,ch:r.getLine(s).length},t=!0}o={line:i.line,ch:i.ch+a},s={line:c.line,ch:c.ch-(t?0:a)},o=r.getRange(o,s).trim(),s=Ue(r),e=e.requestRange(i,c);if(e!==ke.OK)return e===ke.CURSOR_INSIDE&&(s.editingExpr=o),null;t=1<a&&0==i.ch&&(t||c.ch>=r.getLine(c.line).length),t=qe(r,i,c,o,a,t);return s.editingExpr=null,t};function qe(e,t,n,r,i,o){var a=document.createElement("span");a.setAttribute("class","hmd-fold-math math-"+(o?2:1)),a.setAttribute("title",r);var l=document.createElement("span");l.setAttribute("class","hmd-fold-math-placeholder"),l.textContent=r,a.appendChild(l);var s=e.markText(t,n,{replacedWith:a});a.addEventListener("click",function(){return Oe(e,s,i)},!1);var c=Ue(e).createRenderer(a,o?"display":"");return c.onChanged=function(){l&&(a.removeChild(l),l=null),s.changed()},s.on("clear",function(){c.clear()}),s.mathRenderer=c,d(function(){return c.isReady()&&(c.startRender(r),1)},5,function(){s.clear()}),s}Me("math",ve,!0);function $e(e,t){var n=this;this.container=e;var r=document.createElement("img");r.setAttribute("class","hmd-math-dumb"),r.addEventListener("load",function(){n.onChanged&&n.onChanged(n.last_expr)},!1),this.img=r,e.appendChild(r)}$e.prototype.startRender=function(e){this.last_expr=e,this.img.src="https://latex.codecogs.com/gif.latex?"+encodeURIComponent(e)},$e.prototype.clear=function(){this.container.removeChild(this.img)},$e.prototype.isReady=function(){return!0};var ze={renderer:$e,onPreview:null,onPreviewEnd:null},ye={};s.hmdFoldMath=ye,R.defineOption("hmdFoldMath",ze,function(e,t){t?"function"==typeof t&&(t={renderer:t}):t={};var n,r=Ue(e);for(n in ze)r[n]=(n in t?t:ze)[n]});var Ke=function(e){var t=this;this.cm=e,new a(function(e){t.onPreview&&t.onPreview(e)},function(){t.onPreviewEnd&&t.onPreviewEnd()},null).bind(this,"editingExpr")};Ke.prototype.createRenderer=function(e,t){return new(this.renderer||$e)(e,t)};var Ue=x("FoldMath",Ke,ze),Se=Object.freeze({MathFolder:ve,insertMathMark:qe,DumbRenderer:$e,defaultOption:ze,suggestedOption:ye,FoldMath:Ke,getAddon:Ue}),We={},S=function(e){return e in We},ee=function(e){var t=document.createElement("span");return t.textContent=We[e],t.title=e,t},le=function(e,t){if(!t.type||!/ formatting-emoji/.test(t.type))return null;var n=e.cm,r={line:e.lineNo,ch:t.start},i={line:e.lineNo,ch:t.end},t=t.string,n=Xe(n);return!n.isEmoji(t)||e.requestRange(r,i)!==ke.OK?null:n.foldEmoji(t,r,i)};Me("emoji",le,!0);var Be={myEmoji:{},emojiRenderer:ee,emojiChecker:S},fe={};s.hmdFoldEmoji=fe,R.defineOption("hmdFoldEmoji",Be,function(e,t){t=t||{};var n,r=Xe(e);for(n in Be)r[n]=(n in t?t:Be)[n]});ve=function(e){this.cm=e};ve.prototype.isEmoji=function(e){return e in this.myEmoji||this.emojiChecker(e)},ve.prototype.foldEmoji=function(e,t,n){var r=this.cm,e=e in this.myEmoji&&this.myEmoji[e](e)||this.emojiRenderer(e);if(!e||!e.tagName)return null;-1===e.className.indexOf("hmd-emoji")&&(e.className+=" hmd-emoji");var i=r.markText(t,n,{replacedWith:e});return e.addEventListener("click",Oe.bind(this,r,i,1),!1),"img"===e.tagName.toLowerCase()&&(e.addEventListener("load",function(){return i.changed()},!1),e.addEventListener("dragstart",function(e){return e.preventDefault()},!1)),i};var Xe=x("FoldEmoji",ve,Be);!function(e){for(var t,n=["smile:ğŸ˜„;laughing:ğŸ˜†;blush:ğŸ˜Š;smiley:ğŸ˜ƒ;relaxed:â˜ºï¸;smirk:ğŸ˜;heart_eyes:ğŸ˜;kissing_heart:ğŸ˜˜;kissing_closed_eyes:ğŸ˜š;flushed:ğŸ˜³;relieved:ğŸ˜Œ;satisfied:ğŸ˜†;grin:ğŸ˜;wink:ğŸ˜‰;stuck_out_tongue_winking_eye:ğŸ˜œ;stuck_out_tongue_closed_eyes:ğŸ˜;grinning:ğŸ˜€;kissing:ğŸ˜—;kissing_smiling_eyes:ğŸ˜™;stuck_out_tongue:ğŸ˜›;sleeping:ğŸ˜´;worried:ğŸ˜Ÿ;frowning:ğŸ˜¦;anguished:ğŸ˜§;open_mouth:ğŸ˜®;grimacing:ğŸ˜¬;confused:ğŸ˜•;hushed:ğŸ˜¯;expressionless:ğŸ˜‘;unamused:ğŸ˜’;sweat_smile:ğŸ˜…;sweat:ğŸ˜“;disappointed_relieved:ğŸ˜¥;weary:ğŸ˜©;pensive:ğŸ˜”;disappointed:ğŸ˜;confounded:ğŸ˜–;fearful:ğŸ˜¨;cold_sweat:ğŸ˜°;persevere:ğŸ˜£;cry:ğŸ˜¢;sob:ğŸ˜­;joy:ğŸ˜‚;astonished:ğŸ˜²;scream:ğŸ˜±;tired_face:ğŸ˜«;angry:ğŸ˜ ;rage:ğŸ˜¡;triumph:ğŸ˜¤;sleepy:ğŸ˜ª;yum:ğŸ˜‹;mask:ğŸ˜·;sunglasses:ğŸ˜;dizzy_face:ğŸ˜µ;imp:ğŸ‘¿;smiling_imp:ğŸ˜ˆ;neutral_face:ğŸ˜;no_mouth:ğŸ˜¶;innocent:ğŸ˜‡;alien:ğŸ‘½;yellow_heart:ğŸ’›;blue_heart:ğŸ’™;purple_heart:ğŸ’œ;heart:â¤ï¸;green_heart:ğŸ’š;broken_heart:ğŸ’”;heartbeat:ğŸ’“;heartpulse:ğŸ’—;two_hearts:ğŸ’•;revolving_hearts:ğŸ’;cupid:ğŸ’˜;sparkling_heart:ğŸ’–;sparkles:âœ¨;star:â­ï¸;star2:ğŸŒŸ;dizzy:ğŸ’«;boom:ğŸ’¥;collision:ğŸ’¥;anger:ğŸ’¢;exclamation:â—ï¸;question:â“;grey_exclamation:â•;grey_question:â”;zzz:ğŸ’¤;dash:ğŸ’¨;sweat_drops:ğŸ’¦;notes:ğŸ¶;musical_note:ğŸµ;fire:ğŸ”¥;hankey:ğŸ’©;poop:ğŸ’©;shit:ğŸ’©;","+1:ğŸ‘;thumbsup:ğŸ‘;-1:ğŸ‘;thumbsdown:ğŸ‘;ok_hand:ğŸ‘Œ;punch:ğŸ‘Š;facepunch:ğŸ‘Š;fist:âœŠ;v:âœŒï¸;wave:ğŸ‘‹;hand:âœ‹;raised_hand:âœ‹;open_hands:ğŸ‘;point_up:â˜ï¸;point_down:ğŸ‘‡;point_left:ğŸ‘ˆ;point_right:ğŸ‘‰;raised_hands:ğŸ™Œ;pray:ğŸ™;point_up_2:ğŸ‘†;clap:ğŸ‘;muscle:ğŸ’ª;metal:ğŸ¤˜;fu:ğŸ–•;walking:ğŸš¶;runner:ğŸƒ;running:ğŸƒ;couple:ğŸ‘«;family:ğŸ‘ª;two_men_holding_hands:ğŸ‘¬;two_women_holding_hands:ğŸ‘­;dancer:ğŸ’ƒ;dancers:ğŸ‘¯;ok_woman:ğŸ™†;no_good:ğŸ™…;information_desk_person:ğŸ’;raising_hand:ğŸ™‹;bride_with_veil:ğŸ‘°;person_with_pouting_face:ğŸ™;person_frowning:ğŸ™;bow:ğŸ™‡;couplekiss::couplekiss:;couple_with_heart:ğŸ’‘;massage:ğŸ’†;haircut:ğŸ’‡;nail_care:ğŸ’…;boy:ğŸ‘¦;girl:ğŸ‘§;woman:ğŸ‘©;man:ğŸ‘¨;baby:ğŸ‘¶;older_woman:ğŸ‘µ;older_man:ğŸ‘´;person_with_blond_hair:ğŸ‘±;man_with_gua_pi_mao:ğŸ‘²;man_with_turban:ğŸ‘³;construction_worker:ğŸ‘·;cop:ğŸ‘®;angel:ğŸ‘¼;princess:ğŸ‘¸;smiley_cat:ğŸ˜º;smile_cat:ğŸ˜¸;heart_eyes_cat:ğŸ˜»;kissing_cat:ğŸ˜½;smirk_cat:ğŸ˜¼;scream_cat:ğŸ™€;crying_cat_face:ğŸ˜¿;joy_cat:ğŸ˜¹;pouting_cat:ğŸ˜¾;japanese_ogre:ğŸ‘¹;japanese_goblin:ğŸ‘º;see_no_evil:ğŸ™ˆ;hear_no_evil:ğŸ™‰;speak_no_evil:ğŸ™Š;guardsman:ğŸ’‚;skull:ğŸ’€;feet:ğŸ¾;lips:ğŸ‘„;kiss:ğŸ’‹;droplet:ğŸ’§;ear:ğŸ‘‚;eyes:ğŸ‘€;nose:ğŸ‘ƒ;tongue:ğŸ‘…;love_letter:ğŸ’Œ;bust_in_silhouette:ğŸ‘¤;busts_in_silhouette:ğŸ‘¥;speech_balloon:ğŸ’¬;","thought_balloon:ğŸ’­;sunny:â˜€ï¸;umbrella:â˜”ï¸;cloud:â˜ï¸;snowflake:â„ï¸;snowman:â›„ï¸;zap:âš¡ï¸;cyclone:ğŸŒ€;foggy:ğŸŒ;ocean:ğŸŒŠ;cat:ğŸ±;dog:ğŸ¶;mouse:ğŸ­;hamster:ğŸ¹;rabbit:ğŸ°;wolf:ğŸº;frog:ğŸ¸;tiger:ğŸ¯;koala:ğŸ¨;bear:ğŸ»;pig:ğŸ·;pig_nose:ğŸ½;cow:ğŸ®;boar:ğŸ—;monkey_face:ğŸµ;monkey:ğŸ’;horse:ğŸ´;racehorse:ğŸ;camel:ğŸ«;sheep:ğŸ‘;elephant:ğŸ˜;panda_face:ğŸ¼;snake:ğŸ;bird:ğŸ¦;baby_chick:ğŸ¤;hatched_chick:ğŸ¥;hatching_chick:ğŸ£;chicken:ğŸ”;penguin:ğŸ§;turtle:ğŸ¢;bug:ğŸ›;honeybee:ğŸ;ant:ğŸœ;beetle:ğŸ;snail:ğŸŒ;octopus:ğŸ™;tropical_fish:ğŸ ;fish:ğŸŸ;whale:ğŸ³;whale2:ğŸ‹;dolphin:ğŸ¬;cow2:ğŸ„;ram:ğŸ;rat:ğŸ€;water_buffalo:ğŸƒ;tiger2:ğŸ…;rabbit2:ğŸ‡;dragon:ğŸ‰;goat:ğŸ;rooster:ğŸ“;dog2:ğŸ•;pig2:ğŸ–;mouse2:ğŸ;ox:ğŸ‚;dragon_face:ğŸ²;blowfish:ğŸ¡;crocodile:ğŸŠ;dromedary_camel:ğŸª;leopard:ğŸ†;cat2:ğŸˆ;poodle:ğŸ©;paw_prints:ğŸ¾;bouquet:ğŸ’;cherry_blossom:ğŸŒ¸;tulip:ğŸŒ·;four_leaf_clover:ğŸ€;rose:ğŸŒ¹;sunflower:ğŸŒ»;hibiscus:ğŸŒº;maple_leaf:ğŸ;leaves:ğŸƒ;fallen_leaf:ğŸ‚;herb:ğŸŒ¿;mushroom:ğŸ„;cactus:ğŸŒµ;palm_tree:ğŸŒ´;evergreen_tree:ğŸŒ²;deciduous_tree:ğŸŒ³;chestnut:ğŸŒ°;seedling:ğŸŒ±;blossom:ğŸŒ¼;ear_of_rice:ğŸŒ¾;shell:ğŸš;globe_with_meridians:ğŸŒ;sun_with_face:ğŸŒ;full_moon_with_face:ğŸŒ;new_moon_with_face:ğŸŒš;new_moon:ğŸŒ‘;waxing_crescent_moon:ğŸŒ’;first_quarter_moon:ğŸŒ“;waxing_gibbous_moon:ğŸŒ”;full_moon:ğŸŒ•;waning_gibbous_moon:ğŸŒ–;last_quarter_moon:ğŸŒ—;waning_crescent_moon:ğŸŒ˜;last_quarter_moon_with_face:ğŸŒœ;","first_quarter_moon_with_face:ğŸŒ›;moon:ğŸŒ”;earth_africa:ğŸŒ;earth_americas:ğŸŒ;earth_asia:ğŸŒ;volcano:ğŸŒ‹;milky_way:ğŸŒŒ;partly_sunny:â›…ï¸;bamboo:ğŸ;gift_heart:ğŸ’;dolls:ğŸ;school_satchel:ğŸ’;mortar_board:ğŸ“;flags:ğŸ;fireworks:ğŸ†;sparkler:ğŸ‡;wind_chime:ğŸ;rice_scene:ğŸ‘;jack_o_lantern:ğŸƒ;ghost:ğŸ‘»;santa:ğŸ…;christmas_tree:ğŸ„;gift:ğŸ;bell:ğŸ””;no_bell:ğŸ”•;tanabata_tree:ğŸ‹;tada:ğŸ‰;confetti_ball:ğŸŠ;balloon:ğŸˆ;crystal_ball:ğŸ”®;cd:ğŸ’¿;dvd:ğŸ“€;floppy_disk:ğŸ’¾;camera:ğŸ“·;video_camera:ğŸ“¹;movie_camera:ğŸ¥;computer:ğŸ’»;tv:ğŸ“º;iphone:ğŸ“±;phone:â˜ï¸;telephone:â˜ï¸;telephone_receiver:ğŸ“;pager:ğŸ“Ÿ;fax:ğŸ“ ;minidisc:ğŸ’½;vhs:ğŸ“¼;sound:ğŸ”‰;speaker:ğŸ”ˆ;mute:ğŸ”‡;loudspeaker:ğŸ“¢;mega:ğŸ“£;hourglass:âŒ›ï¸;hourglass_flowing_sand:â³;alarm_clock:â°;watch:âŒšï¸;radio:ğŸ“»;satellite:ğŸ“¡;loop:â¿;mag:ğŸ”;mag_right:ğŸ”;unlock:ğŸ”“;lock:ğŸ”’;lock_with_ink_pen:ğŸ”;closed_lock_with_key:ğŸ”;key:ğŸ”‘;bulb:ğŸ’¡;flashlight:ğŸ”¦;high_brightness:ğŸ”†;low_brightness:ğŸ”…;electric_plug:ğŸ”Œ;battery:ğŸ”‹;calling:ğŸ“²;email:âœ‰ï¸;mailbox:ğŸ“«;postbox:ğŸ“®;bath:ğŸ›€;bathtub:ğŸ›;shower:ğŸš¿;toilet:ğŸš½;wrench:ğŸ”§;nut_and_bolt:ğŸ”©;hammer:ğŸ”¨;seat:ğŸ’º;moneybag:ğŸ’°;yen:ğŸ’´;dollar:ğŸ’µ;pound:ğŸ’·;euro:ğŸ’¶;","credit_card:ğŸ’³;money_with_wings:ğŸ’¸;e-mail:ğŸ“§;inbox_tray:ğŸ“¥;outbox_tray:ğŸ“¤;envelope:âœ‰ï¸;incoming_envelope:ğŸ“¨;postal_horn:ğŸ“¯;mailbox_closed:ğŸ“ª;mailbox_with_mail:ğŸ“¬;mailbox_with_no_mail:ğŸ“­;door:ğŸšª;smoking:ğŸš¬;bomb:ğŸ’£;gun:ğŸ”«;hocho:ğŸ”ª;pill:ğŸ’Š;syringe:ğŸ’‰;page_facing_up:ğŸ“„;page_with_curl:ğŸ“ƒ;bookmark_tabs:ğŸ“‘;bar_chart:ğŸ“Š;chart_with_upwards_trend:ğŸ“ˆ;chart_with_downwards_trend:ğŸ“‰;scroll:ğŸ“œ;clipboard:ğŸ“‹;calendar:ğŸ“†;date:ğŸ“…;card_index:ğŸ“‡;file_folder:ğŸ“;open_file_folder:ğŸ“‚;scissors:âœ‚ï¸;pushpin:ğŸ“Œ;paperclip:ğŸ“;black_nib:âœ’ï¸;pencil2:âœï¸;straight_ruler:ğŸ“;triangular_ruler:ğŸ“;closed_book:ğŸ“•;green_book:ğŸ“—;blue_book:ğŸ“˜;orange_book:ğŸ“™;notebook:ğŸ““;notebook_with_decorative_cover:ğŸ“”;ledger:ğŸ“’;books:ğŸ“š;bookmark:ğŸ”–;name_badge:ğŸ“›;microscope:ğŸ”¬;telescope:ğŸ”­;newspaper:ğŸ“°;football:ğŸˆ;basketball:ğŸ€;soccer:âš½ï¸;baseball:âš¾ï¸;tennis:ğŸ¾;8ball:ğŸ±;","rugby_football:ğŸ‰;bowling:ğŸ³;golf:â›³ï¸;mountain_bicyclist:ğŸšµ;bicyclist:ğŸš´;horse_racing:ğŸ‡;snowboarder:ğŸ‚;swimmer:ğŸŠ;surfer:ğŸ„;ski:ğŸ¿;spades:â™ ï¸;hearts:â™¥ï¸;clubs:â™£ï¸;diamonds:â™¦ï¸;gem:ğŸ’;ring:ğŸ’;trophy:ğŸ†;musical_score:ğŸ¼;musical_keyboard:ğŸ¹;violin:ğŸ»;space_invader:ğŸ‘¾;video_game:ğŸ®;black_joker:ğŸƒ;flower_playing_cards:ğŸ´;game_die:ğŸ²;dart:ğŸ¯;mahjong:ğŸ€„ï¸;clapper:ğŸ¬;memo:ğŸ“;pencil:ğŸ“;book:ğŸ“–;art:ğŸ¨;microphone:ğŸ¤;headphones:ğŸ§;trumpet:ğŸº;saxophone:ğŸ·;guitar:ğŸ¸;shoe:ğŸ‘;sandal:ğŸ‘¡;high_heel:ğŸ‘ ;lipstick:ğŸ’„;boot:ğŸ‘¢;shirt:ğŸ‘•;tshirt:ğŸ‘•;necktie:ğŸ‘”;womans_clothes:ğŸ‘š;dress:ğŸ‘—;running_shirt_with_sash:ğŸ½;jeans:ğŸ‘–;kimono:ğŸ‘˜;bikini:ğŸ‘™;ribbon:ğŸ€;tophat:ğŸ©;crown:ğŸ‘‘;womans_hat:ğŸ‘’;mans_shoe:ğŸ‘;closed_umbrella:ğŸŒ‚;briefcase:ğŸ’¼;handbag:ğŸ‘œ;pouch:ğŸ‘;purse:ğŸ‘›;eyeglasses:ğŸ‘“;fishing_pole_and_fish:ğŸ£;coffee:â˜•ï¸;tea:ğŸµ;sake:ğŸ¶;baby_bottle:ğŸ¼;beer:ğŸº;beers:ğŸ»;cocktail:ğŸ¸;tropical_drink:ğŸ¹;wine_glass:ğŸ·;fork_and_knife:ğŸ´;pizza:ğŸ•;hamburger:ğŸ”;fries:ğŸŸ;poultry_leg:ğŸ—;meat_on_bone:ğŸ–;spaghetti:ğŸ;curry:ğŸ›;fried_shrimp:ğŸ¤;bento:ğŸ±;sushi:ğŸ£;fish_cake:ğŸ¥;rice_ball:ğŸ™;rice_cracker:ğŸ˜;rice:ğŸš;","ramen:ğŸœ;stew:ğŸ²;oden:ğŸ¢;dango:ğŸ¡;egg:ğŸ¥š;bread:ğŸ;doughnut:ğŸ©;custard:ğŸ®;icecream:ğŸ¦;ice_cream:ğŸ¨;shaved_ice:ğŸ§;birthday:ğŸ‚;cake:ğŸ°;cookie:ğŸª;chocolate_bar:ğŸ«;candy:ğŸ¬;lollipop:ğŸ­;honey_pot:ğŸ¯;apple:ğŸ;green_apple:ğŸ;tangerine:ğŸŠ;lemon:ğŸ‹;cherries:ğŸ’;grapes:ğŸ‡;watermelon:ğŸ‰;strawberry:ğŸ“;peach:ğŸ‘;melon:ğŸˆ;banana:ğŸŒ;pear:ğŸ;pineapple:ğŸ;sweet_potato:ğŸ ;eggplant:ğŸ†;tomato:ğŸ…;corn:ğŸŒ½;house:ğŸ ;house_with_garden:ğŸ¡;school:ğŸ«;office:ğŸ¢;post_office:ğŸ£;hospital:ğŸ¥;bank:ğŸ¦;convenience_store:ğŸª;love_hotel:ğŸ©;hotel:ğŸ¨;wedding:ğŸ’’;church:â›ªï¸;department_store:ğŸ¬;european_post_office:ğŸ¤;city_sunrise:ğŸŒ‡;city_sunset:ğŸŒ†;japanese_castle:ğŸ¯;european_castle:ğŸ°;tent:â›ºï¸;factory:ğŸ­;tokyo_tower:ğŸ—¼;japan:ğŸ—¾;mount_fuji:ğŸ—»;sunrise_over_mountains:ğŸŒ„;sunrise:ğŸŒ…;stars:ğŸŒ ;statue_of_liberty:ğŸ—½;bridge_at_night:ğŸŒ‰;carousel_horse:ğŸ ;rainbow:ğŸŒˆ;ferris_wheel:ğŸ¡;fountain:â›²ï¸;roller_coaster:ğŸ¢;ship:ğŸš¢;speedboat:ğŸš¤;boat:â›µï¸;sailboat:â›µï¸;rowboat:ğŸš£;anchor:âš“ï¸;rocket:ğŸš€;airplane:âœˆï¸;helicopter:ğŸš;steam_locomotive:ğŸš‚;tram:ğŸšŠ;mountain_railway:ğŸš;bike:ğŸš²;aerial_tramway:ğŸš¡;suspension_railway:ğŸšŸ;","mountain_cableway:ğŸš ;tractor:ğŸšœ;blue_car:ğŸš™;oncoming_automobile:ğŸš˜;car:ğŸš—;red_car:ğŸš—;taxi:ğŸš•;oncoming_taxi:ğŸš–;articulated_lorry:ğŸš›;bus:ğŸšŒ;oncoming_bus:ğŸš;rotating_light:ğŸš¨;police_car:ğŸš“;oncoming_police_car:ğŸš”;fire_engine:ğŸš’;ambulance:ğŸš‘;minibus:ğŸš;truck:ğŸšš;train:ğŸš‹;station:ğŸš‰;train2:ğŸš†;bullettrain_front:ğŸš…;bullettrain_side:ğŸš„;light_rail:ğŸšˆ;monorail:ğŸš;railway_car:ğŸšƒ;trolleybus:ğŸš;ticket:ğŸ«;fuelpump:â›½ï¸;vertical_traffic_light:ğŸš¦;traffic_light:ğŸš¥;warning:âš ï¸;construction:ğŸš§;beginner:ğŸ”°;atm:ğŸ§;slot_machine:ğŸ°;busstop:ğŸš;barber:ğŸ’ˆ;hotsprings:â™¨ï¸;checkered_flag:ğŸ;crossed_flags:ğŸŒ;izakaya_lantern:ğŸ®;moyai:ğŸ—¿;circus_tent:ğŸª;performing_arts:ğŸ­;round_pushpin:ğŸ“;triangular_flag_on_post:ğŸš©;jp:ğŸ‡¯ğŸ‡µ;kr:ğŸ‡°ğŸ‡·;cn:ğŸ‡¨ğŸ‡³;us:ğŸ‡ºğŸ‡¸;fr:ğŸ‡«ğŸ‡·;es:ğŸ‡ªğŸ‡¸;it:ğŸ‡®ğŸ‡¹;ru:ğŸ‡·ğŸ‡º;gb:ğŸ‡¬ğŸ‡§;uk:ğŸ‡¬ğŸ‡§;de:ğŸ‡©ğŸ‡ª;one:1ï¸âƒ£;two:2ï¸âƒ£;three:3ï¸âƒ£;four:4ï¸âƒ£;five:5ï¸âƒ£;six:6ï¸âƒ£;seven:7ï¸âƒ£;eight:8ï¸âƒ£;nine:9ï¸âƒ£;keycap_ten:ğŸ”Ÿ;","1234:ğŸ”¢;zero:0ï¸âƒ£;hash:#ï¸âƒ£;symbols:ğŸ”£;arrow_backward:â—€ï¸;arrow_down:â¬‡ï¸;arrow_forward:â–¶ï¸;arrow_left:â¬…ï¸;capital_abcd:ğŸ” ;abcd:ğŸ”¡;abc:ğŸ”¤;arrow_lower_left:â†™ï¸;arrow_lower_right:â†˜ï¸;arrow_right:â¡ï¸;arrow_up:â¬†ï¸;arrow_upper_left:â†–ï¸;arrow_upper_right:â†—ï¸;arrow_double_down:â¬;arrow_double_up:â«;arrow_down_small:ğŸ”½;arrow_heading_down:â¤µï¸;arrow_heading_up:â¤´ï¸;leftwards_arrow_with_hook:â†©ï¸;arrow_right_hook:â†ªï¸;left_right_arrow:â†”ï¸;arrow_up_down:â†•ï¸;arrow_up_small:ğŸ”¼;arrows_clockwise:ğŸ”ƒ;arrows_counterclockwise:ğŸ”„;rewind:âª;fast_forward:â©;information_source:â„¹ï¸;ok:ğŸ†—;twisted_rightwards_arrows:ğŸ”€;repeat:ğŸ”;repeat_one:ğŸ”‚;new:ğŸ†•;top:ğŸ”;up:ğŸ†™;cool:ğŸ†’;free:ğŸ†“;ng:ğŸ†–;cinema:ğŸ¦;koko:ğŸˆ;signal_strength:ğŸ“¶;u5272:ğŸˆ¹;u5408:ğŸˆ´;u55b6:ğŸˆº;u6307:ğŸˆ¯ï¸;u6708:ğŸˆ·ï¸;u6709:ğŸˆ¶;u6e80:ğŸˆµ;u7121:ğŸˆšï¸;u7533:ğŸˆ¸;u7a7a:ğŸˆ³;u7981:ğŸˆ²;sa:ğŸˆ‚ï¸;restroom:ğŸš»;mens:ğŸš¹;womens:ğŸšº;baby_symbol:ğŸš¼;no_smoking:ğŸš­;","parking:ğŸ…¿ï¸;wheelchair:â™¿ï¸;metro:ğŸš‡;baggage_claim:ğŸ›„;accept:ğŸ‰‘;wc:ğŸš¾;potable_water:ğŸš°;put_litter_in_its_place:ğŸš®;secret:ãŠ™ï¸;congratulations:ãŠ—ï¸;m:â“‚ï¸;passport_control:ğŸ›‚;left_luggage:ğŸ›…;customs:ğŸ›ƒ;ideograph_advantage:ğŸ‰;cl:ğŸ†‘;sos:ğŸ†˜;id:ğŸ†”;no_entry_sign:ğŸš«;underage:ğŸ”;no_mobile_phones:ğŸ“µ;do_not_litter:ğŸš¯;non-potable_water:ğŸš±;no_bicycles:ğŸš³;no_pedestrians:ğŸš·;children_crossing:ğŸš¸;no_entry:â›”ï¸;eight_spoked_asterisk:âœ³ï¸;eight_pointed_black_star:âœ´ï¸;heart_decoration:ğŸ’Ÿ;vs:ğŸ†š;vibration_mode:ğŸ“³;mobile_phone_off:ğŸ“´;chart:ğŸ’¹;currency_exchange:ğŸ’±;aries:â™ˆï¸;taurus:â™‰ï¸;gemini:â™Šï¸;cancer:â™‹ï¸;leo:â™Œï¸;virgo:â™ï¸;libra:â™ï¸;scorpius:â™ï¸;","sagittarius:â™ï¸;capricorn:â™‘ï¸;aquarius:â™’ï¸;pisces:â™“ï¸;ophiuchus:â›;six_pointed_star:ğŸ”¯;negative_squared_cross_mark:â;a:ğŸ…°ï¸;b:ğŸ…±ï¸;ab:ğŸ†;o2:ğŸ…¾ï¸;diamond_shape_with_a_dot_inside:ğŸ’ ;recycle:â™»ï¸;end:ğŸ”š;on:ğŸ”›;soon:ğŸ”œ;clock1:ğŸ•;clock130:ğŸ•œ;clock10:ğŸ•™;clock1030:ğŸ•¥;clock11:ğŸ•š;clock1130:ğŸ•¦;clock12:ğŸ•›;clock1230:ğŸ•§;clock2:ğŸ•‘;clock230:ğŸ•;clock3:ğŸ•’;clock330:ğŸ•;clock4:ğŸ•“;clock430:ğŸ•Ÿ;clock5:ğŸ•”;clock530:ğŸ• ;clock6:ğŸ••;clock630:ğŸ•¡;clock7:ğŸ•–;clock730:ğŸ•¢;clock8:ğŸ•—;clock830:ğŸ•£;clock9:ğŸ•˜;clock930:ğŸ•¤;heavy_dollar_sign:ğŸ’²;copyright:Â©ï¸;registered:Â®ï¸;tm:â„¢ï¸;x:âŒ;heavy_exclamation_mark:â—ï¸;bangbang:â€¼ï¸;interrobang:â‰ï¸;o:â­•ï¸;heavy_multiplication_x:âœ–ï¸;","heavy_plus_sign:â•;heavy_minus_sign:â–;heavy_division_sign:â—;white_flower:ğŸ’®;100:ğŸ’¯;heavy_check_mark:âœ”ï¸;ballot_box_with_check:â˜‘ï¸;radio_button:ğŸ”˜;link:ğŸ”—;curly_loop:â°;wavy_dash:ã€°ï¸;part_alternation_mark:ã€½ï¸;trident:ğŸ”±;black_square::black_square:;white_square::white_square:;white_check_mark:âœ…;black_square_button:ğŸ”²;white_square_button:ğŸ”³;black_circle:âš«ï¸;white_circle:âšªï¸;red_circle:ğŸ”´;large_blue_circle:ğŸ”µ;large_blue_diamond:ğŸ”·;large_orange_diamond:ğŸ”¶;small_blue_diamond:ğŸ”¹;small_orange_diamond:ğŸ”¸;small_red_triangle:ğŸ”º;small_red_triangle_down:ğŸ”»"],r=/([-\w]+:)([^;]+);/g,i=0;i<n.length;i++)for(r.lastIndex=0;t=r.exec(n[i]);)e[":"+t[1]]=t[2]}(We);var ye=Object.freeze({defaultDict:We,defaultChecker:S,defaultRenderer:ee,EmojiFolder:le,defaultOption:Be,suggestedOption:fe,FoldEmoji:ve,getAddon:Xe}),Ke=function(e){return!/^<(?:br)/i.test(e)&&(!/<(?:script|style|link|meta)/i.test(e)&&(!/\son\w+\s*=/i.test(e)&&!/src\s*=\s*["']?javascript:/i.test(e)))},S=function(e,t,a){var n=/^<(\w+)\s*/.exec(e);if(!n)return null;for(var r,i,o=n[1],l=document.createElement(o),s=/([\w\:\-]+)(?:\s*=\s*((['"]).*?\3|\S+))?\s*/g,c=s.lastIndex=n[0].length;(r=s.exec(e))&&!(r.index>c);){var d=r[1],h=r[2];h&&/^['"]/.test(h)&&(h=h.slice(1,-1)),l.setAttribute(d,h),c=s.lastIndex}return"innerHTML"in l&&(i=e.indexOf(">",c)+1,n=e.length,(r=new RegExp("</"+o+"\\s*>\\s*$","i").exec(e))&&(n=r.index),(n=e.slice(i,n))&&(l.innerHTML=n),m([l],function(e){var t=e.tagName.toLowerCase();"a"===t&&(e.getAttribute("target")||e.setAttribute("target","_blank"));var n={a:["href"],img:["src"],iframe:["src"]}[t];if(n)for(var r=0;r<n.length;r++){var i=n[r],o=e.getAttribute(i);o&&e.setAttribute(i,a.hmdResolveURL(o))}})),l},Ye="hmd-fold-html-stub",ee=function(e,t){if(!t.type||!/ hmd-html-begin/.test(t.type))return null;var n=e.findNext(/ hmd-html-\w+/,!0);if(!n||!/ hmd-html-end/.test(n.token.type)||/ hmd-html-unclosed/.test(n.token.type))return null;var r=e.cm,i={line:e.lineNo,ch:t.start},o={line:n.lineNo,ch:n.token.end},a=0!=i.ch||o.ch<r.getLine(o.line).length,t=Ve(r),n=r.getRange(i,o);return!t.checker(n,i,r)||e.requestRange(i,o)!==ke.OK?null:t.renderAndInsert(n,i,o,a)};Me("html",ee,!1);var Ge={checker:Ke,renderer:S,stubText:"<HTML>",isolatedTagName:/^(?:div|pre|form|table|iframe|ul|ol|input|textarea|p|summary|a)$/i},le={};s.hmdFoldHTML=le,R.defineOption("hmdFoldHTML",Ge,function(e,t){t?"function"==typeof t?t={checker:t}:"object"!=typeof t&&(console.warn("[HyperMD][FoldHTML] incorrect option value type"),t={}):t={};var n,r=Ve(e);for(n in Ge)r[n]=(n in t?t:Ge)[n];!r.isolatedTagName||r.isolatedTagName instanceof RegExp||(console.error("[HyperMD][FoldHTML] option isolatedTagName only accepts RegExp"),r.isolatedTagName=Ge.isolatedTagName)});fe=function(e){this.cm=e};fe.prototype.renderAndInsert=function(e,t,n,r){var i,o,a,l,s,c,d=this.cm,h=this.makeStub(),u=this.renderer(e,t,d),e=function(){return Oe(d,i)};return u?(h.addEventListener("click",e,!1),u.tagName.match(this.isolatedTagName||/^$/)||u.addEventListener("click",e,!1),r?((o=document.createElement("span")).setAttribute("class","hmd-fold-html"),o.setAttribute("style","display: inline-block"),o.appendChild(h),o.appendChild(u),o=o,(c=f(u,function(e,t){var n=getComputedStyle(u),r=function(e){return n.getPropertyValue(e)},r=e<10||t<10||!/^relative|static$/i.test(r("position"))||!/^none$/i.test(r("float"));h.className=r?Ye:"hmd-fold-html-stub omittable",i.changed()})).check(),setTimeout(function(){i.on("clear",function(){c.stop()})},0)):(o=h,a=d.addLineWidget(n.line,u,{above:!1,coverGutter:!1,noHScroll:!1,showIfHidden:!1}),l=function(){return h.className="hmd-fold-html-stub highlight"},s=function(){return h.className=Ye},u.addEventListener("mouseenter",l,!1),u.addEventListener("mouseleave",s,!1),(c=f(u,function(){return a.changed()})).check(),setTimeout(function(){i.on("clear",function(){c.stop(),a.clear(),u.removeEventListener("mouseenter",l,!1),u.removeEventListener("mouseleave",s,!1)})},0)),i=d.markText(t,n,{replacedWith:o})):null},fe.prototype.makeStub=function(){var e=document.createElement("span");return e.setAttribute("class",Ye),e.textContent=this.stubText||"<HTML>",e};var Ve=x("FoldHTML",fe,Ge),ve=Object.freeze({defaultChecker:Ke,defaultRenderer:S,HTMLFolder:ee,defaultOption:Ge,suggestedOption:le,FoldHTML:fe,getAddon:Ve}),Ze={enabled:!1},Ke={enabled:!0};s.hmdTableAlign=Ke,c.hmdTableAlign=!1,R.defineOption("hmdTableAlign",Ze,function(e,t){var n=!!t;n&&"boolean"!=typeof t||(t={enabled:n});var r,i=Qe(e);for(r in Ze)i[r]=(r in t?t:Ze)[r]});S=function(e){var m=this;this.cm=e,this.styleEl=document.createElement("style"),this.updateStyle=u(function(){var e,t;m.enabled&&(e=m.cm,t=m.measure(),(t=m.makeCSS(t))!==m._lastCSS&&(m.styleEl.textContent=m._lastCSS=t,e.refresh()))},100),this._procLine=function(e,t,n){if(n.querySelector(".cm-hmd-table-sep")){for(var r=n.firstElementChild,n=Array.prototype.slice.call(r.childNodes,0),t=e.getStateAfter(t.lineNo()),i=t.hmdTableColumns,o=t.hmdTableID,a=2===t.hmdTable?-1:0,l=m.makeColumn(a,i[a]||"dummy",o),s=l.firstElementChild,c=0,d=n;c<d.length;c+=1){var h=d[c],u=h.nodeType===Node.ELEMENT_NODE&&h.className||"";/cm-hmd-table-sep/.test(u)?(a++,l.appendChild(s),r.appendChild(l),r.appendChild(h),s=(l=m.makeColumn(a,i[a]||"dummy",o)).firstElementChild):s.appendChild(h)}l.appendChild(s),r.appendChild(l)}},new a(function(){e.on("renderLine",m._procLine),e.on("update",m.updateStyle),e.refresh(),document.head.appendChild(m.styleEl)},function(){e.off("renderLine",m._procLine),e.off("update",m.updateStyle),document.head.removeChild(m.styleEl)}).bind(this,"enabled",!0)};S.prototype.makeColumn=function(e,t,n){var r=document.createElement("span");r.className="hmd-table-column hmd-table-column-"+e+" hmd-table-column-"+t,r.setAttribute("data-column",""+e),r.setAttribute("data-table-id",n);n=document.createElement("span");return n.className="hmd-table-column-content",n.setAttribute("data-column",""+e),r.appendChild(n),r},S.prototype.measure=function(){for(var e=this.cm.display.lineDiv.querySelectorAll(".hmd-table-column-content"),t={},n=0;n<e.length;n++){var r=e[n],i=r.parentElement,o=i.getAttribute("data-table-id"),a=~~i.getAttribute("data-column"),r=r.offsetWidth+1;o in t||(t[o]=[]);for(var l=t[o];l.length<=a;)l.push(0);l[a]<r&&(l[a]=r)}return t},S.prototype.makeCSS=function(e){var t,n=[];for(t in e)for(var r=e[t],i="pre.HyperMD-table-row.HyperMD-table_"+t+" .hmd-table-column-",o=0;o<r.length;o++){var a=r[o];n.push(i+o+" { min-width: "+(a+.5)+"px }")}return n.join("\n")};var Qe=x("TableAlign",S,Ze),ee=Object.freeze({defaultOption:Ze,suggestedOption:Ke,TableAlign:S,getAddon:Qe}),Je={source:null},et={source:"function"==typeof requirejs?"~codemirror/":"https://cdn.jsdelivr.net/npm/codemirror/"};s.hmdModeLoader=et,R.defineOption("hmdModeLoader",Je,function(e,t){t&&"boolean"!=typeof t?"string"!=typeof t&&"function"!=typeof t||(t={source:t}):t={source:t&&et.source||null};var n,r=tt(e);for(n in Je)r[n]=(n in t?t:Je)[n]});le=function(e){var r=this;this.cm=e,this._loadingModes={},this.rlHandler=function(e,t){var n=t.lineNo(),t=(t.text||"").match(/^```\s*(\S+)/);t&&(t=t[1],!(t=(t=R.findModeByName(t))&&t.mode)||t in R.modes||r.startLoadMode(t,n))},(new a).bind(this,"source").ON(function(){e.on("renderLine",r.rlHandler)}).OFF(function(){e.off("renderLine",r.rlHandler)})};le.prototype.touchLine=function(e){var t=this.cm.getLineHandle(e),n=t.text.length;this.cm.replaceRange(t.text.charAt(n-1),{line:e,ch:n-1},{line:e,ch:n})},le.prototype.startLoadMode=function(e,t){var n,r,i,o,a=this._loadingModes,l=this;0<=t&&e in a?a[e].push(t):(0<=t&&(a[e]=[t]),n=function(){console.log("[HyperMD] mode-loader loaded "+e);var t=a[e];l.cm.operation(function(){for(var e=0;e<t.length;e++)l.touchLine(t[e])}),delete a[e]},r=function(){console.warn("[HyperMD] mode-loader failed to load mode "+e+" from ",i),-1!==t&&(console.log("[HyperMD] mode-loader will retry loading "+e),setTimeout(function(){l.startLoadMode(e,0<=t?-3:t+1)},1e3))},"function"!=typeof this.source?(i=this.source+"mode/"+e+"/"+e+".js","function"==typeof requirejs&&"~"===i.charAt(0)?requirejs([i.slice(1,-3)],n):((o=document.createElement("script")).onload=n,o.onerror=r,o.src=i,document.head.appendChild(o))):this.source(e,n,r))};var tt=x("ModeLoader",le,Je),fe=Object.freeze({defaultOption:Je,suggestedOption:et,ModeLoader:le,getAddon:tt});function nt(e,t){var n=" "+e.className+" ",t=" "+t+" ";return-1!==n.indexOf(t)&&(e.className=n.replace(t,"").trim(),1)}function rt(e,t){var n=" "+t+" ";return-1===(" "+e.className+" ").indexOf(n)&&(e.className=e.className+" "+t,1)}var it={enabled:!1,line:!0,tokenTypes:"em|strong|strikethrough|code|linkText|task".split("|")},Ke={enabled:!0};s.hmdHideToken=Ke,c.hmdHideToken=!1,R.defineOption("hmdHideToken",it,function(e,t){t&&"boolean"!=typeof t?"string"==typeof t?t={enabled:!0,tokenTypes:t.split("|")}:t instanceof Array&&(t={enabled:!0,tokenTypes:t}):t={enabled:!!t};var n,r=lt(e);for(n in it)r[n]=(n in t?t:it)[n]});var ot="hmd-hidden-token",at="hmd-inactive-line",S=function(e){var r=this;this.cm=e,this.renderLineHandler=function(e,t,n){r.procLine(t,n)},this.cursorActivityHandler=function(e){r.update()},this.update=u(function(){return r.updateImmediately()},100),this._rangesInLine={},new a(function(){e.on("cursorActivity",r.cursorActivityHandler),e.on("renderLine",r.renderLineHandler),e.on("update",r.update),r.update(),e.refresh()},function(){e.off("cursorActivity",r.cursorActivityHandler),e.off("renderLine",r.renderLineHandler),e.off("update",r.update),r.update.stop(),e.refresh()}).bind(this,"enabled",!0)};S.prototype.procLine=function(e,t){var n=this.cm,r="number"==typeof e?e:e.lineNo();"number"==typeof e&&(e=n.getLineHandle(e));var i=this._rangesInLine[r]||[],o=b(n,r);if(!o||o.hidden||!o.measure)return!1;if(!(t=t||o.text))return!1;var d=_(o,e,r).map,h=d.length/3,a=!1;0===i.length?rt(t,at)&&(a=!0):nt(t,at)&&(a=!0);for(var l=T(n).extract(r),s=0,c=0;c<l.length;c++){var u=l[c];if(-1!==this.tokenTypes.indexOf(u.type)){for(var m=[{line:r,ch:u.begin},{line:r,ch:u.end}],f=u.begin;s<h&&d[3*s+1]<f;)s++;for(var p=!0,g=0;g<i.length;g++)if(k(m,i[g])){p=!1;break}!function(e,t,n){for(var r=!1,i=n=n||0;i<h;i++){var o=d[3*i],a=(d[3*i+1],d[3*i+2]);if(o===e.head.start)if(!/formatting-/.test(e.head.type)||a.nodeType!==Node.TEXT_NODE||(t?rt:nt)(a.parentElement,ot)&&(r=!0),e.tail&&/formatting-/.test(e.tail.type))for(var l=i+1;l<h;l++){var s=d[3*l],c=(d[3*l+1],d[3*l+2]);if(s==e.tail.start&&(c.nodeType!==Node.TEXT_NODE||(t?rt:nt)(c.parentElement,ot)&&(r=!0)),s>=e.tail.end)break}if(o>=e.begin)break}return r}(u,p,s)||(a=!0)}}return a&&(delete o.measure.heights,o.measure.cache={}),a},S.prototype.updateImmediately=function(){var r=this;this.update.stop();for(var i=this.cm,e=i.listSelections(),o={},a={},l=this._rangesInLine,t=0,n=e;t<n.length;t+=1){var s=g(n[t]),c=s[0].line,d=s[1].line;o[c]=o[d]=!0;for(var h=c;h<=d;h++)a[h]?a[h].push(s):a[h]=[s]}this._rangesInLine=a,i.operation(function(){for(var e in l)a[e]||r.procLine(~~e);var t,n=!1;for(t in a)r.procLine(~~t)&&o[t]&&(n=!0);n&&i.refresh()})};var lt=x("HideToken",S,it),le=Object.freeze({defaultOption:it,suggestedOption:Ke,HideToken:S,getAddon:lt}),st={enabled:!1},Ke={enabled:!0};s.hmdCursorDebounce=Ke,R.defineOption("hmdCursorDebounce",st,function(e,t){t&&"boolean"!=typeof t||(t={enabled:!!t});var n,r=dt(e);for(n in st)r[n]=(n in t?t:st)[n]});function ct(e){return/hmd-table-sep/.test(e.type)&&!/hmd-table-sep-dummy/.test(e.type)}var S=function(e){var r=this;this.cm=e,this.mouseDownHandler=function(e,t){r.lastX=t.clientX,r.lastY=t.clientY;var n=r.mouseMoveSuppress;document.addEventListener("mousemove",n,!0),r.lastTimeout&&clearTimeout(r.lastTimeout),r.lastTimeout=setTimeout(function(){document.removeEventListener("mousemove",n,!0),r.lastTimeout=null},100)},this.mouseMoveSuppress=function(e){Math.abs(e.clientX-r.lastX)<=5&&Math.abs(e.clientY-r.lastY)<=5&&e.stopPropagation()},new a(function(){e.on("mousedown",r.mouseDownHandler)},function(){e.off("mousedown",r.mouseDownHandler)}).bind(this,"enabled",!0)},dt=x("CursorDebounce",S,st),Ke=Object.freeze({defaultOption:st,suggestedOption:Ke,CursorDebounce:S,getAddon:dt}),ht=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,ut=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,mt=/[*+-]\s/,ft=/^(\s*)([*+-]\s|(\d+)([.)]))(\s*)/;function pt(e){if(e.getOption("disableInput"))return R.Pass;for(var t=[],n=0,r=e.listSelections();n<r.length;n+=1){var i,o,a,l=r[n],f=l.head,s=l.empty(),c=e.getStateAfter(f.line),d=e.getLine(f.line),h=!1;if(h||(i=!1!==c.list,o=c.quote,a=ht.exec(d),l=/^\s*$/.test(d.slice(0,f.ch)),s&&(i||o)&&a&&!l&&(h=!0,ut.test(d)?(/>\s*$/.test(d)||e.replaceRange("",{line:f.line,ch:0},{line:f.line,ch:f.ch+1}),t.push("\n")):(l=a[1],u=a[5],p=(m=!(mt.test(a[2])||0<=a[2].indexOf(">")))?parseInt(a[3],10)+1+a[4]:a[2].replace("x"," "),t.push("\n"+l+p+u),m&&function(e){var t=ht,n=f.line,r=0,i=0,o=t.exec(e.getLine(n)),a=o[1];do{var l=n+(r+=1),s=e.getLine(l),c=t.exec(s);if(c){var d=c[1],h=parseInt(o[3],10)+r-i,u=parseInt(c[3],10),m=u;if(a!==d||isNaN(u)){if(a.length>d.length)return;if(a.length<d.length&&1===r)return;i+=1}else h===u&&(m=u+1),u<h&&(m=1+h),e.replaceRange(s.replace(t,d+m+c[4]+c[5]),{line:l,ch:0},{line:l,ch:s.length})}}while(c)}(e)))),!h){var u,m,p=s?c.hmdTable:0;if(0!=p)return!/^[\s\|]+$/.test(d)||f.line!==e.lastLine()&&e.getStateAfter(f.line+1).hmdTable===p?(u=j("  |  ",c.hmdTableColumns.length-1),m="\n",2===p&&(m+="| ",u+=" |"),0==c.hmdTableRow?e.setCursor({line:f.line+1,ch:e.getLine(f.line+1).length}):e.setCursor({line:f.line,ch:d.length}),e.replaceSelection(m),e.replaceSelection(u,"start")):(e.setCursor({line:f.line,ch:0}),e.replaceRange("\n",{line:f.line,ch:0},{line:f.line,ch:d.length})),void(h=!0);if(s&&f.ch>=d.length&&!c.code&&!c.hmdInnerMode&&/^\|.+\|.+\|$/.test(d)){for(var g=e.getLineTokens(f.line),b="|",_="|",v=1;v<g.length;v++){var k=g[v];"|"!==k.string||k.type&&k.type.trim().length||(b+=" ------- |",_+="   |")}return e.setCursor({line:f.line,ch:d.length}),e.replaceSelection("\n"+b+"\n| "),e.replaceSelection(_.slice(1)+"\n","start"),void(h=!0)}}if(h||s&&"$$"==d.slice(f.ch-2,f.ch)&&/math-end/.test(e.getTokenTypeAt(f))&&(t.push("\n"),h=!0),!h)return void e.execCommand("newlineAndIndent")}e.replaceSelections(t)}function gt(e){if(e.getOption("disableInput"))return R.Pass;for(var t=e.listSelections(),n=o("\n",t.length),r=0;r<t.length;r++){var i=t[r].head,i=e.getStateAfter(i.line);!1!==i.list&&(n[r]+=j(" ",i.listStack.slice(-1)[0]))}e.replaceSelections(n)}function bt(e,t,n){var r;!n||n<0||0<(n=(r=/^ */.exec(e.getLine(t))[0].length)<n?r:n)&&e.replaceRange("",{line:t,ch:0},{line:t,ch:n})}function _t(e){for(var t=e.listSelections(),n=new I(e),r=0;r<t.length;r++){var i=t[r],o=i.head,a=i.anchor;!i.empty()&&0<R.cmpPos(o,a)?(a=(u=[o,a])[0],o=u[1]):a===o&&(a=i.anchor={ch:o.ch,line:o.line});var l=e.getStateAfter(o.line);if(l.hmdTable){n.setPos(o.line,o.ch);var s=2===l.hmdTable,c=o.line,d=e.getLine(c),h=0,u=0,i=n.findPrev(ct);if(i){var m,h=(m=n.findPrev(ct,i.i_token-1))?m.token.end:0,u=i.token.start;0==h&&s&&(h+=d.match(/^\s*\|/)[0].length)}else{if(0==l.hmdTableRow)return;2==l.hmdTableRow&&c--,c--,d=e.getLine(c),n.setPos(c,d.length),h=(m=n.findPrev(ct)).token.end,u=d.length,s&&(u-=d.match(/\|\s*$/)[0].length)}return" "===d.charAt(h)&&(h+=1),0<h&&" |"===d.substr(h-1,2)&&h--," "===d.charAt(u-1)&&--u,void e.setSelection({line:c,ch:h},{line:c,ch:u})}if(0<l.listStack.length){for(var f=o.line;!ft.test(e.getLine(f));)if(f--,!(0<e.getStateAfter(f).listStack.length)){f++;break}for(var p=e.lastLine(),g=void 0;f<=a.line&&(g=ft.exec(e.getLine(f)));f++){var b=e.getStateAfter(f).listStack,_=b.length,v=0;for(bt(e,f,v=1==_?g[1].length:b[_-1]-(b[_-2]||0));++f<=p;){if(e.getStateAfter(f).listStack.length!==_){f=1/0;break}if(ft.test(e.getLine(f))){f--;break}bt(e,f,v)}}return}}e.execCommand("indentLess")}function vt(e){var t=e.listSelections(),n=[],r=[],i=[],o={},a=new I(e),l=!1,s=!1,c=!1,d=!0;function h(e){(n[p]=e)&&(s=!0)}function u(e){(r[p]=e)&&(c=!0)}function m(e){(i[p]=e)&&(d=!0)}for(var f,p=0;p<t.length;p++){n[p]=r[p]=i[p]="";var g=t[p],b=g.head,_=g.anchor,v=g.empty();!v&&0<R.cmpPos(b,_)?(_=(T=[b,_])[0],b=T[1]):_===b&&(_=g.anchor={ch:b.ch,line:b.line});var k=e.getStateAfter(b.line),y=e.getLine(b.line);if(k.hmdTable){var l=!0,w=2===k.hmdTable,T=k.hmdTableColumns;a.setPos(b.line,b.ch);var x,L,g=a.findNext(ct,a.i_token);g?(L=a.findNext(/hmd-table-sep/,g.i_token+1),b.ch=g.token.end,_.ch=L?L.token.start:y.length,_.ch>b.ch&&" "===y.charAt(b.ch)&&b.ch++,_.ch>b.ch&&" "===y.charAt(_.ch-1)&&_.ch--,m(_.ch>b.ch?e.getRange(b,_):"")):(L=0===k.hmdTableRow?2:1,b.line+L>e.lastLine()||e.getStateAfter(b.line+L).hmdTable!=k.hmdTable?(b.ch=_.ch=y.length,x=j("  |  ",T.length-1),0===k.hmdTableRow&&(_.line=b.line+=1,_.ch=b.ch=e.getLine(b.line).length),w?(h("\n| "),u(x+" |")):(h("\n"),u(x.trimRight())),m("")):(_.line=b.line+=L,a.setPos(b.line,0),x=a.line.text,L=w&&a.findNext(/hmd-table-sep-dummy/,0),w=a.findNext(/hmd-table-sep/,L?L.i_token+1:1),b.ch=L?L.token.end:0,_.ch=w?w.token.start:x.length,_.ch>b.ch&&" "===x.charAt(b.ch)&&b.ch++,_.ch>b.ch&&" "===x.charAt(_.ch-1)&&_.ch--,m(_.ch>b.ch?e.getRange(b,_):"")))}else if(0<k.listStack.length){for(var M=b.line,O=void 0;!(O=ft.exec(e.getLine(M)));)if(M--,!(0<e.getStateAfter(M).listStack.length)){M++;break}for(var C=e.firstLine(),H=e.lastLine();M<=_.line&&(O=ft.exec(e.getLine(M)));M++){var S=e.getStateAfter(M).listStack,E=e.getStateAfter(M-1).listStack,D=S.length,N="";for(C<M&&D<=E.length&&(N=D==E.length?j(" ",E[D-1]-O[1].length):j(" ",E[D]-O[0].length)),o[M]=N;++M<=H;){if(e.getStateAfter(M).listStack.length!==D){M=1/0;break}if(ft.test(e.getLine(M))){M--;break}o[M]=N}}if(!v){d=!1;break}}else if(v)h("    ");else{m(e.getRange(b,_));for(var A=b.line;A<=_.line;A++)A in o||(o[A]="    ")}}for(f in o)o[f]&&e.replaceRange(o[f],{line:~~f,ch:0});l&&e.setSelections(t),s&&e.replaceSelections(n),c&&e.replaceSelections(r,"start"),d&&e.replaceSelections(i,"around")}function kt(p,g,b){return function(e){if(e.getOption("disableInput"))return R.Pass;for(var t=new I(e),n=e.listSelections(),r=new Array(n.length),i=0;i<n.length;i++){var o=n[i],a=o.head,l=o.anchor,s=e.getStateAfter(a.line),c=o.empty();0<R.cmpPos(a,l)&&(l=(m=[a,l])[0],a=m[1]);var d=r[i]=c?"":e.getRange(a,l);if(c||p(e.getTokenAt(a).state)){var h=a.line;t.setPos(h,a.ch,!0);(f=t.lineTokens[t.i_token])&&f.state;f&&!/^\s*$/.test(f.string)||(f=t.lineTokens[--t.i_token]);var u=t.expandRange(function(e){return e&&(p(e.state)||g(e))}),o=u.from,m=u.to;if(m.i_token===o.i_token){l=b();if(f&&!/^\s*$/.test(f.string)){var c={line:h,ch:f.start},u={line:h,ch:f.end},f=o.token;return e.replaceRange(l+f.string+l,c,u),u.ch+=l.length,void e.setCursor(u)}r[i]=l}else g(m.token)&&e.replaceRange("",{line:h,ch:m.token.start},{line:h,ch:m.token.end}),o.i_token!==m.i_token&&g(o.token)&&e.replaceRange("",{line:h,ch:o.token.start},{line:h,ch:o.token.end})}else{a=e.getTokenAt(a),s=a?a.state:s,s=b(s);r[i]=s+d+s}}e.replaceSelections(r)}}Object.assign(R.commands,{hmdNewlineAndContinue:pt,hmdNewline:gt,hmdShiftTab:_t,hmdTab:vt});var S=R.keyMap.default===R.keyMap.macDefault?"Cmd":"Ctrl",yt={"Shift-Tab":"hmdShiftTab",Tab:"hmdTab",Enter:"hmdNewlineAndContinue","Shift-Enter":"hmdNewline"};yt[S+"-B"]=kt(function(e){return e.strong},function(e){return/ formatting-strong /.test(e.type)},function(e){return j(e&&e.strong||"*",2)}),yt[S+"-I"]=kt(function(e){return e.em},function(e){return/ formatting-em /.test(e.type)},function(e){return e&&e.em||"*"}),yt[S+"-D"]=kt(function(e){return e.strikethrough},function(e){return/ formatting-strikethrough /.test(e.type)},function(e){return"~~"}),yt.fallthrough="default",yt=R.normalizeKeyMap(yt),R.keyMap.hypermd=yt,s.keyMap="hypermd";S=Object.freeze({newlineAndContinue:pt,newline:gt,shiftTab:_t,tab:vt,wrapTexts:function(e,t,n){if(e.getOption("disableInput"))return R.Pass;var r=e.listSelections(),i=new Array(r.length),o=new Array(r.length),a=!1,l=!1,s=!1;n=n||t;for(var c=t.length,d=n.length,h=0;h<r.length;h++){i[h]=o[h]="";var u,m=r[h],f=m.head,p=m.anchor,g=e.getLine(f.line);m.empty()?f.ch>=c&&g.substr(f.ch-c,c)===t?(s=!0,f.ch-=c):(l=!0,o[h]=t):(a=!0,0<R.cmpPos(f,p)&&(p=(u=[f,p])[0],f=u[1]),u=e.getRange(f,p),f.ch>=c&&f.line===p.line&&g.substr(f.ch-c,c)===t&&g.substr(p.ch,d)===n&&(s=!0,p.ch+=d,f.ch-=c,u=t+u+n),u.slice(0,c)===t&&u.slice(-d)===n?i[h]=u.slice(c,-d):i[h]=t+u+n)}s&&e.setSelections(r),l&&e.replaceSelections(o),a&&e.replaceSelections(i,"around")},createStyleToggler:kt,get keyMap(){return yt}});e.cmpPos=R.cmpPos,e.Mode=O,e.InsertFile=D,e.ReadLink=ne,e.Hover=he,e.Click=be,e.Paste=Te,e.Fold=H,e.FoldImage=J,e.FoldLink=ae,e.FoldCode=pe,e.FoldMath=Se,e.FoldEmoji=ye,e.FoldHTML=ve,e.TableAlign=ee,e.ModeLoader=fe,e.HideToken=le,e.CursorDebounce=Ke,e.KeyMap=S,e.Addon=L,e.FlipFlop=a,e.tryToRun=d,e.debounce=u,e.addClass=t,e.rmClass=n,e.contains=r,e.repeat=o,e.repeatStr=j,e.visitElements=m,e.watchSize=f,e.makeSymbol=i,e.suggestedEditorConfig=s,e.normalVisualConfig=c,e.fromTextArea=function(e,t){return t=Object.assign(Object.assign({},s),t),(t=R.fromTextArea(e,t))[l]=!0,t},e.switchToNormal=function(e,t){if(e[l]){"string"==typeof t&&(t={theme:t});var n,r=Object.assign(Object.assign({},c),t);for(n in r)e.setOption(n,r[n])}},e.switchToHyperMD=function(e,t){"string"==typeof t&&(t={theme:t});var n,r={};if(l in e){for(var i in c)r[i]=s[i];Object.assign(r,t)}else Object.assign(r,s,t),e[l]=!0;for(n in r)e.setOption(n,r[n])},e.cm_internal=p,e.TokenSeeker=I,e.getEveryCharToken=function(e){var t=new Array(e.text.length),n=e.styles,r=0;if(n)for(var i=1;i<n.length;i+=2)for(var o=n[i],a=n[i+1];r<o;)t[r++]=a;else for(var l=(e.parent.cm||e.parent.parent.cm||e.parent.parent.parent.cm).getLineTokens(e.lineNo()),s=0;s<l.length;s++)for(var c=l[s].end,d=l[s].type;r<c;)t[r++]=d;return t},e.expandRange=v,e.orderedRange=g,e.rangesIntersect=k,e.getLineSpanExtractor=T,Object.defineProperty(e,"__esModule",{value:!0})});
